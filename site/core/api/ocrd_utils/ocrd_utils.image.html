<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ocrd_utils.image module &#8212; ocrd 3.0.0
 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=acc74ff5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/ocrd-custom.js?v=285d69d9"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ocrd_utils.introspect module" href="ocrd_utils.introspect.html" />
    <link rel="prev" title="ocrd_utils.deprecate module" href="ocrd_utils.deprecate.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  
    <link rel="canonical" href="https://ocr-d.deapi/ocrd_utils/ocrd_utils.image.html" />
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-ocrd_utils.image">
<span id="ocrd-utils-image-module"></span><h1>ocrd_utils.image module<a class="headerlink" href="#module-ocrd_utils.image" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.adjust_canvas_to_rotation">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">adjust_canvas_to_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#adjust_canvas_to_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.adjust_canvas_to_rotation" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the enlarged image size after rotation.</p>
<p>Given a numpy array <code class="docutils literal notranslate"><span class="pre">size</span></code> of an original canvas (width and height),
and a rotation angle in degrees counter-clockwise <code class="docutils literal notranslate"><span class="pre">angle</span></code>,
calculate the new size which is necessary to encompass the full
image after rotation.</p>
<p>Return a numpy array of the enlarged width and height.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.adjust_canvas_to_transposition">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">adjust_canvas_to_transposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#adjust_canvas_to_transposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.adjust_canvas_to_transposition" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the flipped image size after transposition.</p>
<p>Given a numpy array <code class="docutils literal notranslate"><span class="pre">size</span></code> of an original canvas (width and height),
and a transposition mode <code class="docutils literal notranslate"><span class="pre">method</span></code> (see <code class="docutils literal notranslate"><span class="pre">transpose_image</span></code>),
calculate the new size after transposition.</p>
<p>Return a numpy array of the enlarged width and height.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.bbox_from_points">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">bbox_from_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#bbox_from_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.bbox_from_points" title="Link to this definition">¶</a></dt>
<dd><p>Construct a numeric list representing a bounding box from polygon coordinates in page representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.bbox_from_polygon">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">bbox_from_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#bbox_from_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.bbox_from_polygon" title="Link to this definition">¶</a></dt>
<dd><p>Construct a numeric list representing a bounding box from polygon coordinates in numeric list representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.bbox_from_xywh">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">bbox_from_xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xywh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#bbox_from_xywh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.bbox_from_xywh" title="Link to this definition">¶</a></dt>
<dd><p>Convert a bounding box from a numeric dict to a numeric list representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.coordinates_for_segment">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">coordinates_for_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#coordinates_for_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.coordinates_for_segment" title="Link to this definition">¶</a></dt>
<dd><p>Convert relative coordinates to absolute.</p>
<p>Given…</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polygon</span></code>, a numpy array of points relative to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent_image</span></code>, a PIL.Image (not used), along with</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent_coords</span></code>, its corresponding affine transformation,</p></li>
</ul>
<p>…calculate the absolute coordinates within the page.</p>
<p>That is, apply the given transform inversely to <code class="docutils literal notranslate"><span class="pre">polygon</span></code>
The transform encodes (recursively):</p>
<ol class="arabic simple">
<li><p>Whenever <code class="docutils literal notranslate"><span class="pre">parent_image</span></code> or any of its parents was cropped,
all points must be shifted by the offset in opposite direction
(i.e. coordinate system gets translated by the upper left).</p></li>
<li><p>Whenever <code class="docutils literal notranslate"><span class="pre">parent_image</span></code> or any of its parents was rotated,
all points must be rotated around the center of that image in
opposite direction
(i.e. coordinate system gets translated by the center in
opposite direction, rotated purely, and translated back;
the latter involves an additional offset from the increase
in canvas size necessary to accommodate all points).</p></li>
</ol>
<p>Return the rounded numpy array of the resulting polygon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.coordinates_of_segment">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">coordinates_of_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#coordinates_of_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.coordinates_of_segment" title="Link to this definition">¶</a></dt>
<dd><p>Extract the coordinates of a PAGE segment element relative to its parent.</p>
<p>Given…</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">segment</span></code>, a PAGE segment object in absolute coordinates
(i.e. RegionType / TextLineType / WordType / GlyphType), and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent_image</span></code>, the PIL.Image of its corresponding parent object
(i.e. PageType / RegionType / TextLineType / WordType), (not used),
along with</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent_coords</span></code>, its corresponding affine transformation,</p></li>
</ul>
<p>…calculate the relative coordinates of the segment within the image.</p>
<p>That is, apply the given transform to the points annotated in <code class="docutils literal notranslate"><span class="pre">segment</span></code>.
The transform encodes (recursively):</p>
<ol class="arabic simple">
<li><p>Whenever <code class="docutils literal notranslate"><span class="pre">parent_image</span></code> or any of its parents was cropped,
all points must be shifted by the offset
(i.e. coordinate system gets translated by the upper left).</p></li>
<li><p>Whenever <code class="docutils literal notranslate"><span class="pre">parent_image</span></code> or any of its parents was rotated,
all points must be rotated around the center of that image
(i.e. coordinate system gets translated by the center in
opposite direction, rotated purely, and translated back;
the latter involves an additional offset from the increase
in canvas size necessary to accommodate all points).</p></li>
</ol>
<p>Return the rounded numpy array of the resulting polygon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.image_from_polygon">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">image_from_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'background'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#image_from_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.image_from_polygon" title="Link to this definition">¶</a></dt>
<dd><p>“Mask an image with a polygon.</p>
<p>Given a PIL.Image <code class="docutils literal notranslate"><span class="pre">image</span></code> and a numpy array <code class="docutils literal notranslate"><span class="pre">polygon</span></code>
of relative coordinates into the image, fill everything
outside the polygon hull to a color according to <code class="docutils literal notranslate"><span class="pre">fill</span></code>:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">none</span></code> then do not touch the colour channels at all,</p></li>
<li><p>else if <code class="docutils literal notranslate"><span class="pre">background</span></code> (the default),
then use the median color of the image;</p></li>
<li><p>otherwise use the given color, e.g. <code class="docutils literal notranslate"><span class="pre">'white'</span></code> or (255,255,255).</p></li>
</ul>
<p>Moreover, if <code class="docutils literal notranslate"><span class="pre">transparency</span></code> is true, then add an alpha channel
from the polygon mask (i.e. everything outside the polygon will
be transparent, for those consumers that can interpret alpha channels).
Images which already have an alpha channel will have it shrunk
from the polygon mask (i.e. everything outside the polygon will
be transparent, in addition to existing transparent pixels).</p>
<p>Return a new PIL.Image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.points_from_bbox">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">points_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#points_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.points_from_bbox" title="Link to this definition">¶</a></dt>
<dd><p>Construct polygon coordinates in page representation from a numeric list representing a bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.points_from_polygon">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">points_from_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#points_from_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.points_from_polygon" title="Link to this definition">¶</a></dt>
<dd><p>Convert polygon coordinates from a numeric list representation to a page representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.points_from_x0y0x1y1">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">points_from_x0y0x1y1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#points_from_x0y0x1y1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.points_from_x0y0x1y1" title="Link to this definition">¶</a></dt>
<dd><p>Construct a polygon representation from a rectangle described as a list [x0, y0, x1, y1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.points_from_xywh">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">points_from_xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#points_from_xywh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.points_from_xywh" title="Link to this definition">¶</a></dt>
<dd><p>Construct polygon coordinates in page representation from numeric dict representing a bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.points_from_y0x0y1x1">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">points_from_y0x0y1x1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yxyx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#points_from_y0x0y1x1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.points_from_y0x0y1x1" title="Link to this definition">¶</a></dt>
<dd><p>Construct a polygon representation from a rectangle described as a list [y0, x0, y1, x1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.polygon_from_bbox">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">polygon_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#polygon_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.polygon_from_bbox" title="Link to this definition">¶</a></dt>
<dd><p>Construct polygon coordinates in numeric list representation from a numeric list representing a bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.polygon_from_points">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">polygon_from_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#polygon_from_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.polygon_from_points" title="Link to this definition">¶</a></dt>
<dd><p>Convert polygon coordinates in page representation to polygon coordinates in numeric list representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.polygon_from_x0y0x1y1">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">polygon_from_x0y0x1y1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0y0x1y1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#polygon_from_x0y0x1y1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.polygon_from_x0y0x1y1" title="Link to this definition">¶</a></dt>
<dd><p>Construct polygon coordinates in numeric list representation from a string list representing a bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.polygon_from_xywh">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">polygon_from_xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xywh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#polygon_from_xywh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.polygon_from_xywh" title="Link to this definition">¶</a></dt>
<dd><p>Construct polygon coordinates in numeric list representation from numeric dict representing a bounding box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.polygon_mask">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">polygon_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#polygon_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.polygon_mask" title="Link to this definition">¶</a></dt>
<dd><p>“Create a mask image of a polygon.</p>
<p>Given a PIL.Image <code class="docutils literal notranslate"><span class="pre">image</span></code> (merely for dimensions), and
a numpy array <code class="docutils literal notranslate"><span class="pre">polygon</span></code> of relative coordinates into the image,
create a new image of the same size with black background, and
fill everything inside the polygon hull with white.</p>
<p>Return the new PIL.Image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.rotate_coordinates">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">rotate_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#rotate_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.rotate_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Compose an affine coordinate transformation with a passive rotation.</p>
<p>Given a numpy array <code class="docutils literal notranslate"><span class="pre">transform</span></code> of an existing transformation
matrix in homogeneous (3d) coordinates, and a rotation angle in
degrees counter-clockwise <code class="docutils literal notranslate"><span class="pre">angle</span></code>, as well as a numpy array
<code class="docutils literal notranslate"><span class="pre">orig</span></code> of the center of rotation, calculate the affine
coordinate transform corresponding to the composition of both
transformations. (This entails translation to the center, followed
by pure rotation, and subsequent translation back. However, since
rotation necessarily increases the bounding box, and thus image size,
do not translate back the same amount, but to the enlarged offset.)</p>
<p>Return a numpy array of the resulting affine transformation matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.shift_coordinates">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">shift_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#shift_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.shift_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Compose an affine coordinate transformation with a translation.</p>
<p>Given a numpy array <code class="docutils literal notranslate"><span class="pre">transform</span></code> of an existing transformation
matrix in homogeneous (3d) coordinates, and a numpy array
<code class="docutils literal notranslate"><span class="pre">offset</span></code> of the translation vector, calculate the affine
coordinate transform corresponding to the composition of both
transformations.</p>
<p>Return a numpy array of the resulting affine transformation matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.scale_coordinates">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">scale_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#scale_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.scale_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Compose an affine coordinate transformation with a proportional scaling.
Given a numpy array <code class="docutils literal notranslate"><span class="pre">transform</span></code> of an existing transformation
matrix in homogeneous (3d) coordinates, and a numpy array
<code class="docutils literal notranslate"><span class="pre">factors</span></code> of the scaling factors, calculate the affine
coordinate transform corresponding to the composition of both
transformations.</p>
<p>Return a numpy array of the resulting affine transformation matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.transform_coordinates">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">transform_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#transform_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.transform_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Apply an affine transformation to a set of points.
Augment the 2d numpy array of points <code class="docutils literal notranslate"><span class="pre">polygon</span></code> with a an extra
column of ones (homogeneous coordinates), then multiply with
the transformation matrix <code class="docutils literal notranslate"><span class="pre">transform</span></code> (or the identity matrix),
and finally remove the extra column from the result.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.transpose_coordinates">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">transpose_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#transpose_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.transpose_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>“Compose an affine coordinate transformation with a transposition (i.e. flip or rotate in 90° multiples).</p>
<p>Given a numpy array <code class="docutils literal notranslate"><span class="pre">transform</span></code> of an existing transformation
matrix in homogeneous (3d) coordinates, a transposition mode <code class="docutils literal notranslate"><span class="pre">method</span></code>,
as well as a numpy array <code class="docutils literal notranslate"><span class="pre">orig</span></code> of the center of the image,
calculate the affine coordinate transform corresponding to the composition
of both transformations, which is respectively:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.FLIP_LEFT_RIGHT</span></code>:
entails translation to the center, followed by pure reflection
about the y-axis, and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.FLIP_TOP_BOTTOM</span></code>:
entails translation to the center, followed by pure reflection
about the x-axis, and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.ROTATE_180</span></code>:
entails translation to the center, followed by pure reflection
about the origin, and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.ROTATE_90</span></code>:
entails translation to the center, followed by pure rotation
by 90° counter-clockwise, and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.ROTATE_270</span></code>:
entails translation to the center, followed by pure rotation
by 270° counter-clockwise, and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.TRANSPOSE</span></code>:
entails translation to the center, followed by pure rotation
by 90° counter-clockwise and pure reflection about the x-axis,
and subsequent translation back</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL.Image.Transpose.TRANSVERSE</span></code>:
entails translation to the center, followed by pure rotation
by 90° counter-clockwise and pure reflection about the y-axis,
and subsequent translation back</p></li>
</ul>
<p>Return a numpy array of the resulting affine transformation matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.xywh_from_bbox">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">xywh_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#xywh_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.xywh_from_bbox" title="Link to this definition">¶</a></dt>
<dd><p>Convert a bounding box from a numeric list to a numeric dict representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.xywh_from_points">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">xywh_from_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#xywh_from_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.xywh_from_points" title="Link to this definition">¶</a></dt>
<dd><p>Construct a numeric dict representing a bounding box from polygon coordinates in page representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ocrd_utils.image.xywh_from_polygon">
<span class="sig-prename descclassname"><span class="pre">ocrd_utils.image.</span></span><span class="sig-name descname"><span class="pre">xywh_from_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ocrd_utils/image.html#xywh_from_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ocrd_utils.image.xywh_from_polygon" title="Link to this definition">¶</a></dt>
<dd><p>Construct a numeric dict representing a bounding box from polygon coordinates in numeric list representation.</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/ocrd-logo-small.png" alt="Logo" />
    
    <h1 class="logo logo-name">OCR-D/core</h1>
    
  </a>
</p>



<p class="blurb">Software library for OCR-D</p>






<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ocrd/modules.html">ocrd</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ocrd_utils</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ocrd_utils.html">ocrd_utils package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ocrd_utils.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.config.html">ocrd_utils.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.constants.html">ocrd_utils.constants module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.deprecate.html">ocrd_utils.deprecate module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ocrd_utils.image module</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.adjust_canvas_to_rotation"><code class="docutils literal notranslate"><span class="pre">adjust_canvas_to_rotation()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.adjust_canvas_to_transposition"><code class="docutils literal notranslate"><span class="pre">adjust_canvas_to_transposition()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.bbox_from_points"><code class="docutils literal notranslate"><span class="pre">bbox_from_points()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.bbox_from_polygon"><code class="docutils literal notranslate"><span class="pre">bbox_from_polygon()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.bbox_from_xywh"><code class="docutils literal notranslate"><span class="pre">bbox_from_xywh()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.coordinates_for_segment"><code class="docutils literal notranslate"><span class="pre">coordinates_for_segment()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.coordinates_of_segment"><code class="docutils literal notranslate"><span class="pre">coordinates_of_segment()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.image_from_polygon"><code class="docutils literal notranslate"><span class="pre">image_from_polygon()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.points_from_bbox"><code class="docutils literal notranslate"><span class="pre">points_from_bbox()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.points_from_polygon"><code class="docutils literal notranslate"><span class="pre">points_from_polygon()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.points_from_x0y0x1y1"><code class="docutils literal notranslate"><span class="pre">points_from_x0y0x1y1()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.points_from_xywh"><code class="docutils literal notranslate"><span class="pre">points_from_xywh()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.points_from_y0x0y1x1"><code class="docutils literal notranslate"><span class="pre">points_from_y0x0y1x1()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.polygon_from_bbox"><code class="docutils literal notranslate"><span class="pre">polygon_from_bbox()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.polygon_from_points"><code class="docutils literal notranslate"><span class="pre">polygon_from_points()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.polygon_from_x0y0x1y1"><code class="docutils literal notranslate"><span class="pre">polygon_from_x0y0x1y1()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.polygon_from_xywh"><code class="docutils literal notranslate"><span class="pre">polygon_from_xywh()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.polygon_mask"><code class="docutils literal notranslate"><span class="pre">polygon_mask()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.rotate_coordinates"><code class="docutils literal notranslate"><span class="pre">rotate_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.shift_coordinates"><code class="docutils literal notranslate"><span class="pre">shift_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.scale_coordinates"><code class="docutils literal notranslate"><span class="pre">scale_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.transform_coordinates"><code class="docutils literal notranslate"><span class="pre">transform_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.transpose_coordinates"><code class="docutils literal notranslate"><span class="pre">transpose_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.xywh_from_bbox"><code class="docutils literal notranslate"><span class="pre">xywh_from_bbox()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.xywh_from_points"><code class="docutils literal notranslate"><span class="pre">xywh_from_points()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#ocrd_utils.image.xywh_from_polygon"><code class="docutils literal notranslate"><span class="pre">xywh_from_polygon()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.introspect.html">ocrd_utils.introspect module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.logging.html">ocrd_utils.logging module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.os.html">ocrd_utils.os module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ocrd_utils.str.html">ocrd_utils.str module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ocrd_modelfactory/modules.html">ocrd_modelfactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocrd_models/modules.html">ocrd_models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocrd_validators/modules.html">ocrd_validators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocrd_network/modules.html">ocrd_network</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ocrd_utils</a><ul>
  <li><a href="ocrd_utils.html">ocrd_utils package</a><ul>
      <li>Previous: <a href="ocrd_utils.deprecate.html" title="previous chapter">ocrd_utils.deprecate module</a></li>
      <li>Next: <a href="ocrd_utils.introspect.html" title="next chapter">ocrd_utils.introspect module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2018-2024, OCR-D.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/api/ocrd_utils/ocrd_utils.image.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>