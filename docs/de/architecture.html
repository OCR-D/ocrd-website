<!DOCTYPE html>
<html lang="de"><head>
  <meta charset="utf-8"/>
  <title>Das OCR-D-Projekt - OCR-D</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/26362587?s=200&amp;v=4" />
  <link href="/assets/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous" />
  <link rel="alternate" type="application/atom+xml" title="OCR-D Blog" href="/feed.xml" />
  <link rel="stylesheet" href="/assets/bulma.css" />
  <link rel="stylesheet" href="/assets/bulma-switch.min.css" />
  <link rel="stylesheet" href="/assets/syntax-highlight.css" />
  <link rel="stylesheet" href="/assets/ocrd.css" />
  <!-- for mathjax support -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['$$', '$$']],
        processEscapes: true,
      },
    }
  </script>
  <script type="text/javascript" id="MathJax-script" async src="/assets/mathjax/es5/tex-chtml.js">
  </script>
</head>
<body>
<script async src="https://cse.google.com/cse.js?cx=15ea814b8c422e7e4"></script>


<script>
function ToggleSearchActive2() {
    var T = document.getElementById("button-header")
	var A = document.getElementById("google-search-header");
    T.style.display = "none";  // <-- Set it to none
	A.style.visibility = "visible";  // <-- Set it to visible
}
</script>


<nav class="navbar is-transparent is-fixed-top">

  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/assets/ocrd-logo-small.png" height="28"/>
    </a>
    <div class="navbar-burger burger" data-target="ocrd-navbar-menu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div id="ocrd-navbar-menu" class="navbar-menu">
    <div class="navbar-start">
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/de/">Über</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/de/blog">Aktuelles</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/about">Über das OCR-D-Projekt</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/phase2">Phase II: Projekte</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/phase3">Phase III: Projekte</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/community">Community</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/publikationen">Publikationen und Vorträge</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/daten">Daten</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/teststellung">Pilotstudie</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/umfrage">Nutzer*innenumfrage</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/kontakt">Kontaktieren Sie uns!</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/de/impressum">Impressum</a>
            

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/de/dev">Technische Dokumentation</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/de/decisions">Decision Log</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/gt-guidelines/trans">Ground Truth Richtlinien</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/gt-guidelines/trans/trPage">PAGE-XML Formatdokumentation</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/dev-best-practice">Best Practices für Softwareentwicklung in OCR-D</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/spec">Spezifikationen</a>

          

          

          
          

            
            <a class="navbar-item" href="/core">OCR-D/core API Dokumentation</a>

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/de/use">Nutzungsinformationen und Anleitungen</a>
        <div class="navbar-dropdown">
          

          
          
            
            
              <a class="navbar-item" href="https://translate.google.com/translate?hl=&sl=en&tl=de&u=https%3A%2F%2Focr-d.de%2Fen%2Fsetup">Setup Anleitung</a>
            

          

          

          
          
            
            
              <a class="navbar-item" href="https://translate.google.com/translate?hl=&sl=en&tl=de&u=https%3A%2F%2Focr-d.de%2Fen%2Fuser_guide">Nutzeranleitung</a>
            

          

          

          
          
            
            
              <a class="navbar-item" href="https://translate.google.com/translate?hl=&sl=en&tl=de&u=https%3A%2F%2Focr-d.de%2Fen%2Fworkflows">Workflows</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/models">Modelle</a>

          

          

          
          

            
            <a class="navbar-item" href="/de/spec/glossary">Glossar</a>

          

          
        </div>
      </div>
      

      
      
        <a class="navbar-item" href="/de/faq">FAQ</a>
      

      
	 <span class="navbar-item">
	
			        
				<div class="navbar-item has-dropdown is-hoverable" style="padding-right:10px">Suche
				<div class="navbar-dropdown" style="font-size: 0.75em; padding:5px">Für diese Funktion haben wir Google Programmable Search Engine implementiert. 
				Wenn Sie diese nutzen, beachten Sie bitte, dass Cookies gespeichert werden können und die Datenschutzbestimmungen von Google LLC gelten:
				<a href="https://policies.google.com/privacy">https://policies.google.com/privacy</a> 
					<button onclick="ToggleSearchActive2()" id="button-header">Einverstanden, zeige die Google-Suche!</button></div>
				</div>
				<div id="google-search-header" style="visibility: hidden">
					<div class="gcse-search"></div>
				</div>
			
	</span>
    </div>

    <div class="navbar-end">

      <span class="navbar-item"><a href="/en/about.html" title="Auf Englisch lesen">en</a>
              
        </span>


    </div> </div> </nav>
<div class="columns">
      
      <aside id="toc-sidebar-content" class="column is-one-third menu is-hidden-mobile">
        <ul class="menu-list column is-one-third">
  <li><a href="#decisions-in-ocr-d">Decisions in OCR-D</a>
    <ul>
      <li><a href="#web-api">Web API</a>
        <ul>
          <li><a href="#what-the-web-api-is">What the Web API is</a></li>
          <li><a href="#why-we-need-a-web-api">Why we need a Web API</a></li>
          <li><a href="#basic-architecture">Basic Architecture</a></li>
        </ul>
      </li>
      <li><a href="#workflows">Workflows</a>
        <ul>
          <li><a href="#what-is-nf-and-why-did-we-choose-it">What is NF and why did we choose it?</a></li>
          <li><a href="#how-is-the-nf-script-structured">How is the NF script structured?</a>
            <ul>
              <li><a href="#21-dsl-and-parameters">2.1 DSL and Parameters</a></li>
              <li><a href="#22-definition-of-processes">2.2 Definition of processes</a></li>
              <li><a href="#23-definition-of-workflows">2.3 Definition of workflows</a></li>
              <li><a href="#24-main-workflow">2.4 Main workflow</a></li>
            </ul>
          </li>
          <li><a href="#which-features-of-nf-do-we-use-ie-what-features-have-to-be-implemented-in-potential-implementations">Which features of NF do we use, i.e. what features have to be implemented in potential implementations?</a></li>
        </ul>
      </li>
      <li><a href="#how-does-parallelization-work-both-within-works-and-across-works">How does parallelization work, both within works and across works?</a></li>
      <li><a href="#how-does-the-nf-script-interact-with-the-processing-server">How does the NF script interact with the processing server?</a></li>
      <li><a href="#how-does-the-nf-script-interact-with-the-mets-server">How does the NF script interact with the METS server?</a></li>
      <li><a href="#how-to-convert-the-existing-ocr-d-process-workflows-we-reference-to-nf">How to convert the existing OCR-D process workflows we reference to NF?</a></li>
      <li><a href="#how-should-nf-scripts-be-written-tested-deployed-and-evaluated">How should NF scripts be written, tested, deployed, and evaluated?</a></li>
      <li><a href="#what-conventions-do-we-encourage-naming-structure-documentation-etc">What conventions do we encourage, naming, structure, documentation, etc.?</a></li>
      <li><a href="#benchmarking">Benchmarking</a></li>
    </ul>
  </li>
</ul>

      </aside>
      <div id="toc-sidebar-toggle">&lt;&gt;</div>
      

      <main class="container content column is-two-thirds" aria-label="Content">
        <h1 id="decisions-in-ocr-d">Decisions in OCR-D</h1>

<p>In a (software project we have to make several decisions …</p>

<h2 id="web-api">Web API</h2>

<h3 id="what-the-web-api-is">What the Web API is</h3>

<h3 id="why-we-need-a-web-api">Why we need a Web API</h3>

<p>The Web API is an important increment for implementers to be able to base their outward-facing HTTP 
interfaces on a common API definition, so that the different implementations are interoperable on this level.</p>

<h3 id="basic-architecture">Basic Architecture</h3>

<h2 id="workflows">Workflows</h2>

<h3 id="what-is-nf-and-why-did-we-choose-it">What is NF and why did we choose it?</h3>

<p>Nextflow is a workflow framework that allows the integration of various scripting languages into a single cohesive pipeline. Nextflow also has its own Domain Specific Language (DSL) that extends Groovy (extension of Java).</p>

<p>We choose it due to its rich set of features:</p>
<ul>
  <li>Stream oriented: Promotes programming approach extending Unix pipes model.</li>
  <li>Fast Prototyping: Let’s you write a computational pipeline from smaller tasks.</li>
  <li>Reproducibility: Supports Docker, Singularity, and 3 other types of containers.</li>
  <li>Portable: Can run locally, Slurm, SGE, PBS, and cloud (Google, Kubernetes, and AWS).</li>
  <li>Continuous checkpoints: Each process in the workflow is checkpointed. It is possible to retry 
failed workflows and start from the last checkpoint.</li>
  <li>Supports various scripting languages including Bash, Python, Perl, and others.</li>
  <li>Enables separation between configuration (how to do) and workflow logic (what to do).</li>
  <li>Modularization of tasks possible via workflow, sub-workflows, and processes.</li>
  <li>Provides detailed logs and various types of execution reports.</li>
</ul>

<h3 id="how-is-the-nf-script-structured">How is the NF script structured?</h3>

<p>The NF script contains the following structures:</p>
<h4 id="21-dsl-and-parameters">2.1 DSL and Parameters</h4>
<h4 id="22-definition-of-processes">2.2 Definition of processes</h4>
<h4 id="23-definition-of-workflows">2.3 Definition of workflows</h4>
<h4 id="24-main-workflow">2.4 Main workflow</h4>

<p>Check this source code example: <a href="https://github.com/MehmedGIT/OPERANDI_TestRepo/blob/master/ExampleWorkflows/Nextflow/workflow4/seq_ocrd_wf_many.nf">seq_ocrd_wf_many.nf</a></p>

<p>TODO: I will provide more structure-related details here based on the example above.</p>

<h3 id="which-features-of-nf-do-we-use-ie-what-features-have-to-be-implemented-in-potential-implementations">Which features of NF do we use, i.e. what features have to be implemented in potential implementations?</h3>
<p>The minimally used features for local runs are the parameters, processes, process decorators, and workflows. I will provide further answers to any following questions related to this main question. I am not sure what else to cover here for now.</p>

<h2 id="how-does-parallelization-work-both-within-works-and-across-works">How does parallelization work, both within works and across works?</h2>

<p>A Nextflow workflow script contains several processes. Processes are executed independently and are isolated from each other (i.e. they do not have a shared memory space). Communication between the processes is possible only through data channels (similar to the pipes model in Unix). These channels are basically asynchronous FIFO queues. Any process can define one or more channels as input and output. The order of interaction between these processes, and ultimately the order of workflow execution depends on the communication channel dependencies between processes. For example, if process A writes data to channel A and process B reads data from channel A, then Nextflow knows that process A must be executed before process B.</p>

<p>Check this source code example: <a href="https://github.com/MehmedGIT/OPERANDI_TestRepo/blob/master/ExampleWorkflows/Nextflow/workflow4/seq_ocrd_wf_many.nf">seq_ocrd_wf_many.nf</a></p>

<p>TODO: I will provide more parallelization details here based on the example above.</p>

<h2 id="how-does-the-nf-script-interact-with-the-processing-server">How does the NF script interact with the processing server?</h2>
<p>There is still no running processing server. More details will be announced once there is more to talk about. The interaction will most probably happen with curl through a bash script inside the Nextflow process. Of course, if it is integrated inside the OCR-D core, then no direct interactions will be needed from inside the Nextflow script.</p>

<h2 id="how-does-the-nf-script-interact-with-the-mets-server">How does the NF script interact with the METS server?</h2>
<p>There is still no running METS server. More details will be announced once there is more to talk about. The interaction will most probably happen with curl through a bash script inside the Nextflow process. Of course, if it is integrated inside the OCR-D core, then no direct interactions will be needed from inside the Nextflow script.</p>

<h2 id="how-to-convert-the-existing-ocr-d-process-workflows-we-reference-to-nf">How to convert the existing OCR-D process workflows we reference to NF?</h2>
<p>I have written an OtoN (OCR-D to Nextflow) converter which converts basic OCR-D process workflows to Nextflow workflow scripts. Check here: <a href="https://github.com/MehmedGIT/OtoN_Converter">OtoN</a></p>

<p>Keep in mind that I have just started working on the converter. It is still very fresh and there are still known problems (related to the produced Nextflow scripts) and I am trying to fix them. It is also not convenient to use (no proper CLI). Neither it has usage instructions. Stay tuned for more updates.</p>

<p>I have tested most edge cases for the lexer/parser of the OCR-D process file while implementing. There may be 
input OCR-D process files that are not handled well enough. Feel free to report any bugs, errors, or lack of errors (when an error is expected).</p>

<p>The tool will probably be a part of the OCR-D software in the future when it is stable enough for general use.</p>

<h2 id="how-should-nf-scripts-be-written-tested-deployed-and-evaluated">How should NF scripts be written, tested, deployed, and evaluated?</h2>
<p>Depends on the use case. Detailed instructions for local executions and example Nextflow workflow scripts can be found here: <a href="https://github.com/MehmedGIT/OPERANDI_TestRepo/tree/master/ExampleWorkflows/Nextflow">Nextflow</a></p>

<p>I will provide further answers to any following questions related to this main question.</p>

<h2 id="what-conventions-do-we-encourage-naming-structure-documentation-etc">What conventions do we encourage, naming, structure, documentation, etc.?</h2>
<p>Try to stick to the structure provided in point 2 when writing Nextflow scripts. You can also check the Nextflow examples provided in point 8. The naming conventions for variables, function names, process names, and workflow names are encouraged to follow the snake case. I will provide further answers to any following questions related to this main question.</p>

<h2 id="benchmarking">Benchmarking</h2>

      </main>
    </div><footer class="footer" style="padding: 1rem">
    <div class="content has-text-centered">
      <img class="footer-logo" src="/assets/dfg_logo_ger.jpg" alt="DFG logo"/>
    </div>
    <!-- <div class="content has-text-centered"> -->
    <!--   <img class="footer-logo" src="/assets/logo-bbaw.png" alt="BBAW logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-hab.gif" alt="HAB logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-kit.png" alt="KIT logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-sbb.png" alt="SBB logo"/> -->
    <!-- </div> -->
    <div class="content has-text-centered">
		<a href="https://github.com/OCR-D">GitHub</a>
		|
		<a href="https://gitter.im/OCR-D/Lobby">Gitter</a>
		|
		<a href="https://twitter.com/OCR_D_community">Twitter</a>
		|
		<a href="https://github.com/OCR-D/ocrd-website/wiki">Wiki</a>
		|
		<a href="https://hub.docker.com/u/ocrd">Docker Hub</a>
		|
		<a href="https://www.zotero.org/groups/418719/ocr-d">Technology Watch</a>
		|
		<a href="/sitemap.xml">sitemap.xml</a>
		|
		
			<a href="/de/impressum">Impressum</a>
		
    </div>

<script src="/assets/script.js"></script>
</footer>
</body>

</html>
