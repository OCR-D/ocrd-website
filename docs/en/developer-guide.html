<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8"/>
  <title>OCR-D Developer Guide - OCR-D</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/26362587?s=200&amp;v=4" />
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />
  <link rel="alternate" type="application/atom+xml" title="OCR-D Blog" href="/feed.xml" />
  <link rel="stylesheet" href="/assets/bulma.css" />
  <link rel="stylesheet" href="/assets/bulma-switch.min.css" />
  <link rel="stylesheet" href="/assets/syntax-highlight.css" />
  <link rel="stylesheet" href="/assets/ocrd.css" />
</head>
<body>
<script async src="https://cse.google.com/cse.js?cx=e9e3f7148e57ed66c"></script>


<script>
function ToggleSearchActive2() {
    var T = document.getElementById("button-header")
	var A = document.getElementById("google-search-header");
    T.style.display = "none";  // <-- Set it to none
	A.style.visibility = "visible";  // <-- Set it to visible
}
</script>


<nav class="navbar is-transparent is-fixed-top">

  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/assets/ocrd-logo-small.png" height="28"/>
    </a>
    <div class="navbar-burger burger" data-target="ocrd-navbar-menu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div id="ocrd-navbar-menu" class="navbar-menu">
    <div class="navbar-start">
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/">About</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/en/blog">News</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/about">About the OCR-D Project</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/phase2">Phase II: Projects</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/phase3">Phase III: Projects</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/community">Community</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/publications">Publications and Presentations</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/data">Data</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/initial-tests">Pilot Study</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/user_survey">User Survey</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/contact">Contacts</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/imprint">Imprint</a>
            

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/dev">Technical Resources</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans">Ground Truth Guidelines</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans/trPage">PAGE-XML format documentation</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/dev-best-practice">OCR-D development best practices</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec">Specifications</a>

          

          

          
          

            
            <a class="navbar-item" href="/core">OCR-D/core API Documentation</a>

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/use">User Guides & Info</a>
        <div class="navbar-dropdown">
          

          
          
            
            
              
              <a class="navbar-item" href="/en/setup">Setup Guide</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/user_guide">User Guide</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/workflows">Workflows</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/models">Models</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec/glossary">Glossary</a>

          

          
        </div>
      </div>
      

      
      
        <a class="navbar-item" href="/en/faq">FAQ</a>
      

      
	 <span class="navbar-item">
	 
            <a href="" title="View in German"></a>
				<div class="navbar-item has-dropdown is-hoverable" style="padding-right:10px">Search
				<div class="navbar-dropdown" style="font-size: 0.75em; padding:5px">For this feature, we implemented Google Programmable Search Engine. 
					If you use it, please note that cookies may be stored and Privacy Policy by Google LLC applies: 
					<a href="https://policies.google.com/privacy">https://policies.google.com/privacy</a> 
					<button onclick="ToggleSearchActive2()" id="button-header">Agree, show me Google Search!</button></div>
				</div>
				<div id="google-search-header" style="visibility: hidden">
					<div class="gcse-search"></div>
				</div>
			
	</span>
    </div>

    <div class="navbar-end">

      <span class="navbar-item">
          </span>


    </div> </div> </nav>
<div class="columns">
      

      <main class="container content column " aria-label="Content">
        <h1 id="ocr-d-developer-guide">OCR-D Developer Guide</h1>

<blockquote>
  <p>A practical guide to the <a href="https://github.com/OCR-D/core">OCR-D framework</a></p>
</blockquote>

<h2 id="introduction">Introduction</h2>

<p>The “OCR-D guide” helps developers writing software and using
tools within the OCR-D ecosystem.</p>

<h3 id="scope-and-purpose-of-the-ocr-d-guide">Scope and purpose of the OCR-D guide</h3>

<p>The OCR-D guide is a collection of concise recipes that provide pragmatic advise on how to</p>

<ul>
  <li>bootstrap a development environment,</li>
  <li>work with the <code class="highlighter-rouge">ocrd</code> command line tool,</li>
  <li>manipulate METS and PAGE documents,</li>
  <li>create <a href="https://ocr-d-github.com/">spec-compliant</a> software</li>
</ul>

<h3 id="notation">Notation</h3>

<p>Lines in code examples</p>

<ul>
  <li>starting with <code class="highlighter-rouge"># </code> are comments;</li>
  <li>starting with <code class="highlighter-rouge">$ </code> are typed shell input (everything after <code class="highlighter-rouge">$ </code> is);</li>
  <li>are output otherwise.</li>
</ul>

<p>Words in ALL CAPS with a preprended <code class="highlighter-rouge">$</code> are variable names:</p>

<ul>
  <li><code class="highlighter-rouge">$METS_URL</code>: URL or file path to a <code class="highlighter-rouge">mets.xml</code> file, e.g.
    <ul>
      <li><code class="highlighter-rouge">https://github.com/OCR-D/assets/raw/master/data/kant_aufklaerung_1784/mets.xml</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">$WORKSPACE_DIR</code>: File path of the workspace created, e.g.
    <ul>
      <li><code class="highlighter-rouge">$WORKSPACE_DIR</code></li>
      <li><code class="highlighter-rouge">/data/ocrd-workspaces/kant-aufklaerung-2018-07-11</code></li>
    </ul>
  </li>
</ul>

<p>When referring to a “<code class="highlighter-rouge">something</code> command”, it is actually <code class="highlighter-rouge">ocrd something</code> on
the command line.</p>

<h3 id="other-ocr-d-documentation">Other OCR-D documentation</h3>

<ul>
  <li><a href="https://ocr-d.github.io">Specification</a>: Formal specifications</li>
  <li><a href="https://ocr-d.github.io/glossary">Glossary</a>: A glossary of terms in the OCR
domain as used throughout our documentation</li>
</ul>

<h2 id="bootstrapping">Bootstrapping</h2>

<h3 id="ubuntu-linux">Ubuntu Linux</h3>

<p>OCR-D development is targeted towards Ubuntu Linux &gt;= 18.04 since it is free,
widely used and well-documented.</p>

<p>Most of the setup will be the same for other Debian-based Linuxes and older
Ubuntu versions. You might run into problems with outdated system packages
though.</p>

<p>In particular, it can be tricky at times to install <code class="highlighter-rouge">tesseract</code> at the right
version. Try <a href="https://launchpad.net/~alex-p/+archive/ubuntu/tesseract-ocr">alex-p’s PPA</a> or build
tesseract from source.</p>

<h3 id="essential-system-packages">Essential system packages</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="se">\</span>
  git <span class="se">\</span>
  build-essential <span class="se">\</span>
  python python-pip <span class="se">\</span>
  python3 python3-pip
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">git</code>: Version control, <a href="https://github.com/OCR-D">OCR-D uses git extensively</a></li>
  <li><code class="highlighter-rouge">build-essential</code>: Installs <code class="highlighter-rouge">make</code> and C/C++ compiler</li>
  <li><code class="highlighter-rouge">python</code>: Python 2.7 for legacy applications like <code class="highlighter-rouge">ocropy</code></li>
  <li><code class="highlighter-rouge">python3</code>: Current version of Python on which <a href="https://github.com/OCR-D/core">the OCR-D software core stack</a> is built</li>
  <li><code class="highlighter-rouge">pip</code>/<code class="highlighter-rouge">pip3</code>: Python package management</li>
</ul>

<h3 id="python-api-and-cli">Python API and CLI</h3>

<p>The OCR-D toolkit is based on a <a href="https://ocr-d.github.io/core">Python API</a> that
you can reuse <a href="#python-setup">if you are developing software in Python</a>.</p>

<p>This API is exposed via a command line tool <code class="highlighter-rouge">ocrd</code>. This CLI offers much of the
same functionality of the API without the need to write Python code and can be readily
integrated into shell scripts and external command callouts in your code.</p>

<p>So, If you <a href="#generic-setup">do not intend to code in Python</a> or want to wrap
existing/legacy tools, a major part of the functionality of the API is
available as a command line tool <code class="highlighter-rouge">ocrd</code>.</p>

<h3 id="python-setup">Python setup</h3>

<h4 id="create-virtualenv">Create virtualenv</h4>

<p>We strongly recommend using <code class="highlighter-rouge">virtualenv</code> (or similar tools if they are more
familiar to you) over system-wide installation of python packages. It reduces
the amount of pain supporting multiple Python versions and allows you to test
your software in various configurations while you develop it, spinning up and
tearing down environments as necessary.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="se">\</span>
  python3-virtualenv <span class="se">\</span>
  python-virtualenv <span class="c"># If you require Python2 compat</span>
</code></pre></div></div>

<p>Create a <code class="highlighter-rouge">virtualenv</code> in an easy to remember or easy-to-search-shell-history-for location:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>virtualenv <span class="nt">-p</span> python3.6 <span class="nv">$HOME</span>/ocrd-venv3
<span class="nv">$ </span>virtualenv <span class="nt">-p</span> python2.7 <span class="nv">$HOME</span>/ocrd-venv2 <span class="c"># If you require Python2 compat</span>
</code></pre></div></div>

<h4 id="activate-virtualenv">Activate virtualenv</h4>

<p>You need to activate this virtual environment whenever you open a new terminal:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> <span class="nv">$HOME</span>/ocrd-venv3/bin/activate
</code></pre></div></div>

<p>If you tend to forget sourcing the script before working on your code, add
<code class="highlighter-rouge">source $HOME/ocrd-venv3</code> to the end of your <code class="highlighter-rouge">.bashrc</code>/<code class="highlighter-rouge">.zshrc</code> file and log
out and back in.</p>

<h4 id="install-ocrd-in-virtualenv-from-pypi">Install <code class="highlighter-rouge">ocrd</code> in virtualenv from pypi</h4>

<p>Make sure, the <a href="#activate-virtualenv"><code class="highlighter-rouge">virtualenv</code> is activated</a> and install <a href="https://pypi.org/projects/ocrd"><code class="highlighter-rouge">ocrd</code></a> with pip:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>ocrd
</code></pre></div></div>

<h3 id="generic-setup">Generic setup</h3>

<p>In this variant, you still need to install the <code class="highlighter-rouge">ocrd</code> Python package. But since
it’s only used for its CLI (and as a dependency for Python-based OCR-D
software), you can install it system-wide:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>pip <span class="nb">install </span>ocrd
</code></pre></div></div>

<h3 id="setup-from-source">Setup from source</h3>

<p>If you want to build the <code class="highlighter-rouge">ocrd</code> package <a href="https://github.com/OCR-D/core">from
source</a> to stay up-to-date on unreleased changes
or to contribute code, you can clone the repository and build from source:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://github.com/OCR-D/core
<span class="nv">$ </span><span class="nb">cd </span>core
</code></pre></div></div>

<p>If you are using the <a href="#python-setup">python setup</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="nv">$ </span>pip <span class="nb">install</span> <span class="nt">-e</span> <span class="nb">.</span>
</code></pre></div></div>

<p>If you are using the <a href="#generic-setup">generic setup</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="nv">$ </span><span class="nb">sudo </span>pip <span class="nb">install</span> <span class="nb">.</span>
</code></pre></div></div>

<h3 id="verify-setup">Verify setup</h3>

<p>After setting up, check that these commands do not throw errors and have the
minimum version:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git <span class="nt">--version</span>
<span class="c"># Version 1.7 or higher?</span>

<span class="nv">$ </span>make <span class="nt">--version</span>
<span class="c"># Version 9.0.1 or higher?</span>

<span class="nv">$ </span>ocrd <span class="nt">--version</span>
<span class="c"># ocrd, version 0.4.0</span>
</code></pre></div></div>

<h2 id="anatomy-of-an-ocr-d-module-project-mp">Anatomy of an OCR-D module project (MP)</h2>

<p>MP are <a href="TODO spec">git repositories</a> with at least a description of the MP and
its provided tools (<a href="#ocrd-tooljson"><code class="highlighter-rouge">ocrd-tool.json</code></a> and a
<a href="#makefile"><code class="highlighter-rouge">Makefile</code></a> for installing the MP into a <a href="#bootstrapping">suitable OS</a>.</p>

<h3 id="ocrd-tooljson"><code class="highlighter-rouge">ocrd-tool.json</code></h3>

<p>This is a JSON file that describes the software of a particular MP. It serves
mainly three purposes:</p>

<ol>
  <li>providing a machine-actionable description of MP and the bundled tools and
their parameters</li>
  <li>concise human-targeted descriptions as the foundation for the <a href="TODO">application
documentation</a></li>
  <li>ensuring compatible definitions and interfaces, which is essential for
sustainable, scalable workflows</li>
</ol>

<p>This document is mainly focusing on the first point.</p>

<p>The structure and syntax of the <code class="highlighter-rouge">ocrd-tool.json</code> is <a href="https://ocr-d.github.io/ocrd_tool#definition">defined by a JSON
Schema</a> and expects JSON Schema
for the parameter definitions. In addition to the schema, the <code class="highlighter-rouge">ocrd</code> command
line tool can help you <a href="#validating-ocr-d-tool-json">validate the ocrd-tool.json</a></p>

<h4 id="mechanics-of-the-ocrd-tooljson">Mechanics of the <code class="highlighter-rouge">ocrd-tool.json</code></h4>

<p>:fire: TODO :fire:</p>

<blockquote>
  <p>[kba] Wir brauchen einen besseren Namen, ich kann das schon nicht mehr
schreiben dauernd, <code class="highlighter-rouge">ocrd-tool.json</code>. Vielleicht einfach <code class="highlighter-rouge">manifest.json</code> oder
<code class="highlighter-rouge">package.json</code> oder <code class="highlighter-rouge">tool-desc</code> odr irgendwas.</p>
</blockquote>

<p>:fire: TODO :fire:</p>

<p>The <code class="highlighter-rouge">ocrd-tool.json</code> has two conceptual levels:</p>

<ul>
  <li><a href="#information-about-the-mp">Information about the MP</a> as a whole and the
people and processes involved</li>
  <li>Technical metadata on the <a href="#metadata-about-the-tools">level of the individual tools</a></li>
</ul>

<p>Beyond the <code class="highlighter-rouge">ocrd-tool.json</code> file, it is part of the requirements that the tools
can provide the section of the <code class="highlighter-rouge">ocrd-tool.json</code> about ‘themselves’ at runtime
with the <a href="#https://ocr-d.github.io/cli#-j---dump-json"><code class="highlighter-rouge">-J</code>/<code class="highlighter-rouge">--dump-json</code> flags</a>.</p>

<p>The reason for this redundancy is to make the tools inspectable at runtime and
to prevent “feature drift” where the  software evolves to the point where the
description/documentation is out-of-date with the actual implementation.</p>

<p>From a developer’s perspective, the easiest way to handle this is by bundling
the <code class="highlighter-rouge">ocrd-tool.json</code> into your software, e.g. by the following pattern:</p>

<ol>
  <li>Store the <code class="highlighter-rouge">ocrd-tool.json</code> at a location where it is easy to deploy and
access <a href="#makefile">after installation</a></li>
  <li>Symlink it to the root of the repository: <code class="highlighter-rouge">ln -sr src/ocrd-tool.json .</code></li>
  <li>Handle <code class="highlighter-rouge">--dump-json</code> by parsing the <code class="highlighter-rouge">ocrd-tool.json</code> and sending out the
relevant section</li>
  <li>Validate input and <a href="#ocrd-tool-tool-parse-params">provide defaults</a> based
on the JSON schema mechanics</li>
</ol>

<h4 id="metadata-about-the-module-project">Metadata about the module project</h4>

<p>Required properties are bold.</p>

<ul>
  <li><strong><code class="highlighter-rouge">version</code></strong>: Version of the tool, <a href="https://semver.org/">adhering to Semantic
Versioning</a></li>
  <li><strong><code class="highlighter-rouge">git_url</code></strong>: URL of the Github</li>
  <li><strong><code class="highlighter-rouge">tool</code></strong>: See <a href="#metadata-about-the-tools">next section</a></li>
  <li><code class="highlighter-rouge">dockerhub</code>: The project’s <a href="https://hub.docker.com">DockerHub</a> URL</li>
  <li><code class="highlighter-rouge">creators</code>: :rotating_light: TODO  :rotating_light::</li>
  <li><code class="highlighter-rouge">institution</code>: :rotating_light: TODO  :rotating_light::</li>
  <li><code class="highlighter-rouge">synopsis</code>: :rotating_light: TODO  :rotating_light::</li>
</ul>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ocrd-blockissifier"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"synopsis"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tools for reasoning about how these blocks fit on this here page"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"git_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://githbub.com/johndoe/ocrd_blocksifier"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dockerhub"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://hub.docker.com/r/johndoe/ocrd_blocksifier"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"authors"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Doe"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe@ocr-corp.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe.github.io"</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nl">"bugs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://github.com/sindresorhus/temp-dir/issues"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"tools"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">/*</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">next</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">*/</span><span class="w">
    </span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="metadata-about-the-tools">Metadata about the tools</h4>

<p>The <code class="highlighter-rouge">tools</code> section is an object with the key being the name of the executable described and the value being an object with the following properties (bold means required):</p>

<ul>
  <li><strong><code class="highlighter-rouge">executable</code></strong>: Name of the executable. Must match the key and start with <code class="highlighter-rouge">ocrd-</code></li>
  <li><code class="highlighter-rouge">parameters</code>: Description of <a href="#metadata-about-parameters">the parameters this tool accepts</a></li>
  <li><strong><code class="highlighter-rouge">description</code></strong>: Concise description what the tool does</li>
  <li><strong><code class="highlighter-rouge">categories</code></strong>: Tools belong to these categories, representing modules within the OCR-D project structure, <a href="https://ocr-d.github.io/ocrd_tool">list is part of the specs</a></li>
  <li><strong><code class="highlighter-rouge">steps</code></strong>: This tool can be used at these steps in the OCR-D functional model, <a href="https://ocr-d.github.io/ocrd_tool">list of values in the specs</a></li>
</ul>

<h4 id="metadata-about-parameters">Metadata about parameters</h4>

<p>Required properties are bold.</p>

<ul>
  <li><strong><code class="highlighter-rouge">type</code></strong>: What kind of parameter this is, either a <code class="highlighter-rouge">string</code>, a <code class="highlighter-rouge">number</code> or a <code class="highlighter-rouge">boolean</code></li>
  <li><code class="highlighter-rouge">format</code>: Subtype defining the syntax of the value such as <code class="highlighter-rouge">float</code>/<code class="highlighter-rouge">integer</code> for numbers or <code class="highlighter-rouge">uri</code> for <code class="highlighter-rouge">string</code></li>
  <li><code class="highlighter-rouge">required</code>: If true, this parameter must be provided by the user</li>
  <li><code class="highlighter-rouge">default</code>: Default value if not required</li>
  <li><code class="highlighter-rouge">enum</code>: List of possible values if a fixed list</li>
</ul>

<p><code class="highlighter-rouge">required: true</code> and setting <code class="highlighter-rouge">default</code> are mutually exclusive.</p>

<h3 id="makefile"><code class="highlighter-rouge">Makefile</code></h3>

<p>All MP should provide a <a href="https://en.wikipedia.org/wiki/Makefile">Makefile</a> with at least two targets: <code class="highlighter-rouge">deps</code> and <code class="highlighter-rouge">install</code>.</p>

<p><code class="highlighter-rouge">make deps</code> should install any dependencies, such as required python modules.</p>

<p><code class="highlighter-rouge">make install</code> should install the executable(s) into <code class="highlighter-rouge">$(PREFIX)/bin</code>.</p>

<p><code class="highlighter-rouge">make test</code> should start the unit/regression test suite if provided.</p>

<h4 id="makefile-for-python-mp"><code class="highlighter-rouge">Makefile</code> for Python MP</h4>

<p><code class="highlighter-rouge">make deps</code> should install dependencies with <code class="highlighter-rouge">pip</code>.</p>

<p><code class="highlighter-rouge">make install</code> should call <code class="highlighter-rouge">python setup.py install</code>.</p>

<p>See the <a href="https://github.com/OCR-D/ocrd_kraken/blob/master/Makefile">makefile of the <code class="highlighter-rouge">ocrd_kraken</code> project</a> for an example.</p>

<h4 id="makefile-for-generic-mp"><code class="highlighter-rouge">Makefile</code> for generic MP</h4>

<p><code class="highlighter-rouge">make deps</code> should install dependencies either by compiling from source or using <code class="highlighter-rouge">apt-get</code>.</p>

<p><code class="highlighter-rouge">make install</code> should</p>

<ul>
  <li>Copy the executables to <code class="highlighter-rouge">$(PREFIX)/bin</code>, creating <code class="highlighter-rouge">$(PREFIX)/bin</code> if necessary.</li>
  <li>Copy any required files to <code class="highlighter-rouge">$(PREFIX)/share/&lt;name-of-the-package&gt;</code>, creating the latter if necessary</li>
</ul>

<p>See the <a href="https://github.com/OCR-D/ocrd_olena/blob/master/Makefile">makefile of the <code class="highlighter-rouge">ocrd_olena</code> project</a> for an example.</p>

<h2 id="ocrd-workspace---working-with-mets"><code class="highlighter-rouge">ocrd workspace</code> - Working with METS</h2>

<p>METS is the container format of choice for OCR-D because it is widely used in
digitzation workflows in cultural heritage institutions.</p>

<p>A METS file references files in file groups and can contain a variety of
metadata, the details can <a href="https://ocr-d.github.io">be found in the specs</a>.</p>

<h3 id="from-mets-to-workspace">From METS to Workspace</h3>

<p>Within the OCR-D toolkit, we use the term “workspace”, a folder containing a
file <code class="highlighter-rouge">mets.xml</code> and any number of the files referenced by the METS.</p>

<p>One can think of the <code class="highlighter-rouge">mets.xml</code> as the MANIFEST of a JAR or the <code class="highlighter-rouge">.git</code> folder
of a git repository.</p>

<p>The <code class="highlighter-rouge">workspace</code> command of the <code class="highlighter-rouge">ocrd</code> tool allows various manipulations of
workspaces and therefore METS files.</p>

<h4 id="git-similarity-intended">Git similarity intended</h4>

<p>The <code class="highlighter-rouge">workspace</code> command’s syntax and mechanics are strongly inspired by
<a href=""><code class="highlighter-rouge">git</code></a> so if you know <code class="highlighter-rouge">git</code>, this should be familiar.</p>

<table>
  <thead>
    <tr>
      <th><code class="highlighter-rouge">git</code></th>
      <th><code class="highlighter-rouge">ocrd workspace</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">init</code></td>
      <td><code class="highlighter-rouge">init</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">clone</code></td>
      <td><code class="highlighter-rouge">clone</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">add</code></td>
      <td><code class="highlighter-rouge">add</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">ls-files</code></td>
      <td><code class="highlighter-rouge">find</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">fetch</code></td>
      <td><code class="highlighter-rouge">find --download</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">archive</code></td>
      <td><code class="highlighter-rouge">pack</code></td>
    </tr>
  </tbody>
</table>

<h4 id="set-the-workspace-to-work-on">Set the workspace to work on</h4>

<p>For most commands, <code class="highlighter-rouge">workspace</code> assumes the workspace is the <em>current working
directory</em>. If you want to use a different directory, use the <code class="highlighter-rouge">-d / --directory</code> option</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Listing files in the workspace at $PWD</span>
<span class="nv">$ </span>ocrd workspace find

<span class="c"># Listing files in the workspace at $WORKSPACE_DIR</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> find
</code></pre></div></div>

<h4 id="use-another-name-than-metsxml">Use another name than <code class="highlighter-rouge">mets.xml</code></h4>

<p>According to <a href="TODO">convention</a>, the METS of a workspace is named <code class="highlighter-rouge">mets.xml</code>.</p>

<p>To select a different basename for that file, use the <code class="highlighter-rouge">-M / --mets-basename</code> option:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Assume this workspace structure</span>
<span class="nv">$ </span>find <span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>/mets3000.xml

<span class="c"># This will fail in a loud and unpleasant manner</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> find

<span class="c"># This will not</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> <span class="nt">-m</span> mets3000.xml find
</code></pre></div></div>

<h3 id="creating-an-empty-workspace">Creating an empty workspace</h3>

<p>To create an empty workspace to which you can add files, use the <code class="highlighter-rouge">workspace init</code> command</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> ws1 init
/home/ocr/ws1
</code></pre></div></div>

<h3 id="load-an-existing-mets-as-a-workspace">Load an existing METS as a workspace</h3>

<p>To create a workspace and save a METS file, use the <code class="highlighter-rouge">workspace clone</code> command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> new-workspace clone <span class="nv">$METS_URL</span>
/home/ocr/new-workspace

<span class="nv">$ </span>find new-workspace
new-workspace
new-workspace/mets.xml
</code></pre></div></div>

<h3 id="load-an-existing-mets-and-referenced-files-as-a-workspace">Load an existing METS and referenced files as a workspace</h3>

<p>To not only <a href="#load-an-existing-mets-as-a-workspace">clone the METS</a> but also
download the contained files, use <code class="highlighter-rouge">workspace clone</code> with the <code class="highlighter-rouge">--download</code> flag:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> clone <span class="nt">--download</span> <span class="nv">$METS_URL</span>

<span class="nv">$ </span>find <span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>/mets.xml
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-GT-ALTO
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-GT-ALTO/kant_aufklaerung_1784_0020.xml
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-GT-PAGE
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-GT-PAGE/kant_aufklaerung_1784_0020.xml
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG/kant_aufklaerung_1784_0020.tif
</code></pre></div></div>

<p><strong>NOTE</strong>: This will download <strong>all</strong> files, which can mean hundreds of
high-resolution images. If you want more fine-grained control,
<a href="#load-an-existing-mets-as-a-workspace">clone the bare workspace</a>
and then 
<a href="downloading-copying-files-to-the-workspace">use the <code class="highlighter-rouge">workspace find</code> command with the <code class="highlighter-rouge">download</code> flag</a></p>

<h3 id="searching-the-files-in-a-mets">Searching the files in a METS</h3>

<p>You can search the files in a METS file with the <code class="highlighter-rouge">workspace find</code> command.</p>

<ul>
  <li>All files: <code class="highlighter-rouge">ocrd workspace find</code></li>
  <li>All TIFF files: <code class="highlighter-rouge">ocrd workspace find --mimetype image/tiff</code></li>
  <li>All TIFF files in the OCR-D-IMG-BIN group: <code class="highlighter-rouge">ocrd workspace find --mimetype image/tiff --file-grp OCR-D-IMG-BIN</code></li>
</ul>

<p>See <code class="highlighter-rouge">ocrd workspace --find</code> for the full range of selection options</p>

<h3 id="downloadingcopying-files-to-the-workspace">Downloading/Copying files to the workspace</h3>

<p>To download remote or copy local files referenced in the <code class="highlighter-rouge">mets.xml</code> to the
workspace, append the <code class="highlighter-rouge">--download</code> flag to the <a href="#searching-the-files-in-a-mets"><code class="highlighter-rouge">workspace find</code>
command</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Clone Bare workspace:</span>
<span class="nv">$ </span>ocrd workspace clone <span class="nv">$METS_URL</span>

<span class="nv">$ </span>find <span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>/mets.xml

<span class="c"># Download all files in the `OCR-D-IMG` file group</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> find <span class="nt">--file-grp</span> OCR-D-IMG <span class="nt">--download</span>
<span class="o">[</span>...]

<span class="nv">$ </span>find <span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>
<span class="nv">$WORKSPACE_DIR</span>/mets.xml
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG/kant_aufklaerung_1784_0020.tif
</code></pre></div></div>

<p>The convention is that files will be downloaded to <code class="highlighter-rouge">$WORKSPACE_DIR/$FILE_GROUP/$BASENAME</code> where</p>

<ul>
  <li><code class="highlighter-rouge">$FILE_GROUP</code> is the <code class="highlighter-rouge">@USE</code> attribute of the <code class="highlighter-rouge">mets:fileGrp</code></li>
  <li><code class="highlighter-rouge">$BASENAME</code> is the last URL segment of the <code class="highlighter-rouge">@xlink:href</code> attribute of the <code class="highlighter-rouge">mets:FLocat</code></li>
</ul>

<p><strong>NOTE</strong> Downloading a file not only copies the file to the <code class="highlighter-rouge">$WORKSPACE_DIR</code>
but also changes the URL of the file from its original to the absolute file
path of the downloaded file.</p>

<h3 id="adding-files-to-the-workspace">Adding files to the workspace</h3>

<p>When running a module project, new files are created (PAGE XML, images …). To
register these new files, they need to be added to the <code class="highlighter-rouge">mets.xml</code> as a
<code class="highlighter-rouge">mets:file</code> with a <code class="highlighter-rouge">mets:FLocat</code> within a <code class="highlighter-rouge">mets:fileGrp</code>, each with the right
attributes. The <code class="highlighter-rouge">workspace add</code> command makes this possible:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> find <span class="nt">-k</span> local_filename
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG/page0013.tif

<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> add <span class="se">\</span>
  <span class="nt">--file-grp</span> OCR-D-IMG-BIN <span class="se">\</span>
  <span class="nt">--file-id</span> PAGE-0013-BIN <span class="se">\</span>
  <span class="nt">--mimetype</span> image/png <span class="se">\</span>
  <span class="nt">--group-id</span> PAGE-0013 <span class="se">\</span>
  page0013binarized.png

<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> find <span class="nt">-k</span> local_filename
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG/page0013.tif
<span class="nv">$WORKSPACE_DIR</span>/OCR-D-IMG-BIN/page0013binarized.tif
</code></pre></div></div>

<h3 id="validating-ocr-d-compliant-mets">Validating OCR-D compliant METS</h3>

<p>To ensure a METS file and the workspace it describes adheres to the <a href="https://ocr-d.github.io/mets">OCR-D
specs</a>, use the <code class="highlighter-rouge">workspace validate</code> command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a bare workspace</span>
ocrd workspace <span class="nt">-d</span>  <span class="nv">$WORKSPACE_DIR</span> init

<span class="c"># Validate</span>
&lt;report <span class="nv">valid</span><span class="o">=</span><span class="s2">"false"</span><span class="o">&gt;</span>
  &lt;error&gt;METS has no unique identifier&lt;/error&gt;
  &lt;error&gt;No files&lt;/error&gt;
&lt;/report&gt;

<span class="c"># Oops, let's set the identifier ...</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> set-id <span class="s1">'scheme://my/identifier/syntax/kant_aufklaerung_1784'</span>

<span class="c"># ... and add a file</span>
<span class="nv">$ </span>ocrd workspace <span class="nt">-d</span> <span class="nv">$WORKSPACE_DIR</span> add <span class="nt">-G</span> OCR-D-IMG-BIN <span class="nt">-i</span> PAGE-0013-BIN <span class="nt">-m</span> image/png <span class="nt">-g</span> PAGE-0013 page0013binarized.png

<span class="c"># Validate again</span>
&lt;report <span class="nv">valid</span><span class="o">=</span><span class="s2">"true"</span><span class="o">&gt;</span>
&lt;/report&gt;
</code></pre></div></div>

<h2 id="ocrd-tool--working-with-ocrd-tooljson"><code class="highlighter-rouge">ocrd tool</code> – Working with ocrd-tool.json</h2>

<p>This command helps you to explore and validate the information in any <a href="#ocrd-tool-json">ocrd-tool.json</a>.</p>

<p>The syntax is <code class="highlighter-rouge">ocrd ocrd-tool /path/to/ocrd-tool.json SUBCOMMAND</code></p>

<h3 id="ocrd-tool-validate"><code class="highlighter-rouge">ocrd-tool validate</code></h3>

<p>Validate that an <code class="highlighter-rouge">ocrd-tool.json</code> is syntactically valid and adheres to the <a href="/ocrd_tool">schema</a>.</p>

<p>This is useful while developing to make sure there are no typos and all required properties are set.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json validate
&lt;report <span class="nv">valid</span><span class="o">=</span><span class="s2">"false"</span><span class="o">&gt;</span>
  &lt;error&gt;[tools.ocrd-wip-xyzzy] <span class="s1">'steps'</span> is a required property&lt;/error&gt;
  &lt;error&gt;[tools.ocrd-wip-xyzzy] <span class="s1">'categories'</span> is a required property&lt;/error&gt;
  &lt;error&gt;[] <span class="s1">'version'</span> is a required property&lt;/error&gt;
&lt;/report&gt;
</code></pre></div></div>

<p>This example shows that the <code class="highlighter-rouge">ocrd-wip-xyzzy</code> executable is missing the required <code class="highlighter-rouge">steps</code> and
<code class="highlighter-rouge">categories</code> properties and the root level object is missing the <code class="highlighter-rouge">version</code>
property.</p>

<p>Adding them should result in</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json validate
&lt;report <span class="nv">valid</span><span class="o">=</span><span class="s2">"true"</span><span class="o">&gt;</span>
&lt;/report&gt;
</code></pre></div></div>

<h3 id="introspect-an-ocrd-tooljson">Introspect an <code class="highlighter-rouge">ocrd-tool.json</code></h3>

<p>These commands are used for enumerating the executables contained in an
<code class="highlighter-rouge">ocrd-tool.json</code> and get root level metadata, such as the version.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json version
0.0.1

<span class="c"># Lists all the tools (executables) one per-line</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json list-tools
ocrd-wip-xyzzy
ocrd-wip-frobozz
</code></pre></div></div>

<h3 id="introspect-individual-tools">Introspect individual tools</h3>

<p>This set of commands allows introspection of the metadata on individual
tools within an <code class="highlighter-rouge">ocrd-tool.json</code>.</p>

<p>The syntax is <code class="highlighter-rouge">ocrd ocrd-tool /path/to/ocrd-tool.json tool EXECUTABLE SUBCOMMAND</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy dump
<span class="o">{</span>
  <span class="s2">"description"</span>: <span class="s2">"Nothing happens"</span>,
  <span class="s2">"categories"</span>: <span class="o">[</span><span class="s2">"Text recognition and optimization"</span>, <span class="s2">"Arcane Magic"</span><span class="o">]</span>,
  <span class="s2">"steps"</span>: <span class="o">[</span><span class="s2">"recognition/text-recognition"</span><span class="o">]</span>,
  <span class="s2">"executable"</span>: <span class="s2">"ocrd-wip-xyzzy"</span>
<span class="o">}</span>

<span class="c"># Description</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy description
Nothing happens

<span class="c"># List categories one per line</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy categories
Text recognition and optimization
Arcane Magic

<span class="c"># List steps one per line</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy steps
recognition/text-recognition
</code></pre></div></div>

<h3 id="parse-parameters">Parse parameters</h3>

<p>The details of how a tool is configured at run-time are determined by
parameters. When a parameter file is passed to a
tool, it should:</p>

<ul>
  <li>ensure it is valid JSON</li>
  <li>validate according to the <a href="#metadata-about-parameters">parameter schema</a></li>
  <li>add default values when no explicit values were provided</li>
</ul>

<p>The <code class="highlighter-rouge">ocrd ocrd-tool tool parse-params</code> command does just that and can output
the resulting default-enriched parameter as either JSON or as shell script
assignments to evaluate:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get JSON</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy parse-params <span class="nt">--json</span> <span class="nt">-p</span> &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s1">'{"val1": 42, "val2": false}'</span><span class="o">)</span>
<span class="o">{</span>
  <span class="s2">"val1"</span>: 42,
  <span class="s2">"val2"</span>: <span class="nb">false</span>,
  <span class="s2">"val-with-default"</span>: 23
<span class="o">}</span>

<span class="c"># Get back shell assignments to an associative array "params"</span>
<span class="nv">$ </span>ocrd ocrd-tool /path/to/ocrd_wip/ocrd-tool.json tool ocrd-wip-xyzzy parse-params <span class="nt">-p</span> &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s1">'{"val1": 42, "val2": false}'</span><span class="o">)</span>
params[<span class="s2">"val1"</span><span class="o">]=</span><span class="s2">"42"</span>
params[<span class="s2">"val2"</span><span class="o">]=</span><span class="s2">"true"</span>
params[<span class="s2">"val-with-default"</span><span class="o">]=</span><span class="s2">"23"</span>
</code></pre></div></div>

<h2 id="ocrd-process---run-a-multi-step-workflow"><code class="highlighter-rouge">ocrd process</code> - Run a multi-step workflow</h2>

<p>OCR requires multiple steps, such as binarization, layout recognition, text
recognition etc. These steps are implemented with command line tools that
adhere <a href="https://ocr-d.github.io/cli">to the same command line interface</a> which
makes it straightforward to chain these calls.</p>

<p>For example, to run kraken binarization and tesseract block segmentation, one could execute:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ocrd-kraken-binarize <span class="nt">-l</span> DEBUG <span class="nt">-I</span> OCR-D-IMG <span class="nt">-O</span> OCR-D-IMG-BIN
ocrd-tesserocrd-segment-block <span class="nt">-l</span> DEBUG <span class="nt">-I</span> OCR-D-IMG-BIN <span class="nt">-O</span> OCR-D-SEG-BLOCK <span class="nt">-p</span> tesseract-params.json
</code></pre></div></div>

<p>The disadvantage of individual calls is that it requires the user to check whether runs were
actually successful. To remedy this, users can use the <code class="highlighter-rouge">ocrd process</code> CLI which</p>

<ul>
  <li>simplifies the CLI syntax for multiple calls</li>
  <li>checks for required and expected-to-be-produced file groups</li>
  <li>checks for return value</li>
  <li>sets logging levels uniformly across tools</li>
</ul>

<p>The same calls mentioned before can be passed to <code class="highlighter-rouge">ocrd process</code> as follows:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ocrd process <span class="nt">-l</span> DEBUG <span class="se">\</span>
  <span class="s2">"kraken-binarize -l DEBUG -I OCR-D-IMG -O OCR-D-IMG-BIN"</span> <span class="se">\</span>
  <span class="s2">"tesserocrd-segment-block -l DEBUG -I OCR-D-IMG-BIN -O OCR-D-SEG-BLOCK -p tesseract-params.json"</span>
</code></pre></div></div>

<h2 id="wrapping-a-cli-using-bash">Wrapping a CLI using <code class="highlighter-rouge">bash</code></h2>

<p>This section describes how you can make an existing tool <a href="/cli">OCR-D
compliant</a>, i.e. provide a CLI which implements all the specs and calls
out to another executable.</p>

<p>For this purpose, the <code class="highlighter-rouge">ocrd</code> offers a <code class="highlighter-rouge">bash</code> library that handles:</p>

<ul>
  <li>command line option parsing</li>
  <li>on-line help</li>
  <li>parsing and providing defaults for parameters</li>
</ul>

<p>The shell library is bundled with the <code class="highlighter-rouge">ocrd</code> command line tool and can be accessed with the
<code class="highlighter-rouge">ocrd bashlib</code> command.</p>

<h3 id="ocrd-bashlib"><code class="highlighter-rouge">ocrd bashlib</code></h3>

<p>To get the filename of the shell lib, use <code class="highlighter-rouge">ocrd bashlib filename</code>, which you
can employ to source the shell code in a wrapper script. After sourcing this script
you will have access to a number of shell functions that begin with <code class="highlighter-rouge">ocrd__</code>.</p>

<p>The only function you definitely need is <code class="highlighter-rouge">ocrd__wrap</code> which parses an
<code class="highlighter-rouge">ocrd-tool.json</code> and scaffolds a spec-compliant CLI, parses command line
arguments and parameters and lets the developer then react to the inputs.</p>

<p>In combination with the <a href="#ocrd-workspace"><code class="highlighter-rouge">ocrd workspace</code></a> command this allows
you to write CLI applications without touching any METS or PAGE/XML files by hand.</p>

<h3 id="ocrd__wrap"><code class="highlighter-rouge">ocrd__wrap</code></h3>

<p><code class="highlighter-rouge">ocrd__wrap</code> has this signature:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ocrd__wrap OCRD_TOOL_JSON EXECUTABLE_NAME ...ARGS
</code></pre></div></div>

<p>where</p>

<ul>
  <li><code class="highlighter-rouge">OCRD_TOOL_JSON</code> is the path to the <code class="highlighter-rouge">ocrd-tool.json</code></li>
  <li><code class="highlighter-rouge">EXECUTABLE_NAME</code> is the name of an executable within <code class="highlighter-rouge">OCRD_TOOL_JSON</code></li>
  <li><code class="highlighter-rouge">...ARGS</code> are 0..n command line arguments passed on from the user</li>
</ul>

<p>Example:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ocrd__wrap /usr/share/ocrd-wip/ocrd-tool.json ocrd-wip-xyzzy <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</code></pre></div></div>


      </main>
    </div><footer class="footer" style="padding: 1rem">
    <div class="content has-text-centered">
      <img class="footer-logo" src="/assets/dfg_logo_eng.jpg" alt="DFG logo"/>
    </div>
    <!-- <div class="content has-text-centered"> -->
    <!--   <img class="footer-logo" src="/assets/logo-bbaw.png" alt="BBAW logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-hab.gif" alt="HAB logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-kit.png" alt="KIT logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-sbb.png" alt="SBB logo"/> -->
    <!-- </div> -->
    <div class="content has-text-centered">
		<a href="https://github.com/OCR-D">GitHub</a>
		|
		<a href="https://gitter.im/OCR-D/Lobby">Gitter</a>
		|
		<a href="https://github.com/OCR-D/ocrd-website/wiki">Wiki</a>
		|
		<a href="https://hub.docker.com/u/ocrd">Docker Hub</a>
		|
		<a href="https://www.zotero.org/groups/418719/ocr-d">Technology Watch</a>
		|
		<a href="/sitemap.xml">sitemap.xml</a>
		|
		
			<a href="/en/imprint">Imprint</a>
		
    </div>

<script src="/assets/script.js"></script>
</footer>
</body>

</html>
