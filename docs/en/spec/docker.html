<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8"/>
  <title>Dockerfile provided by MP - OCR-D</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/26362587?s=200&amp;v=4" />
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />
  <link rel="alternate" type="application/atom+xml" title="OCR-D Blog" href="/feed.xml" />
  <link rel="stylesheet" href="/assets/bulma.css" />
  <link rel="stylesheet" href="/assets/bulma-switch.min.css" />
  <link rel="stylesheet" href="/assets/syntax-highlight.css" />
  <link rel="stylesheet" href="/assets/ocrd.css" />
</head>
<body>
<script async src="https://cse.google.com/cse.js?cx=e9e3f7148e57ed66c"></script>


<script>
function ToggleSearchActive2() {
    var T = document.getElementById("button-header")
	var A = document.getElementById("google-search-header");
    T.style.display = "none";  // <-- Set it to none
	A.style.visibility = "visible";  // <-- Set it to visible
}
</script>


<nav class="navbar is-transparent is-fixed-top">

  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/assets/ocrd-logo-small.png" height="28"/>
    </a>
    <div class="navbar-burger burger" data-target="ocrd-navbar-menu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div id="ocrd-navbar-menu" class="navbar-menu">
    <div class="navbar-start">
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/">About</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/en/blog">News</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/about">About the OCR-D Project</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/phase2">Phase II: Projects</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/phase3">Phase III: Projects</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/community">Community</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/publications">Publications and Presentations</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/data">Data</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/initial-tests">Pilot Study</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/user_survey">User Survey</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/contact">Contacts</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/imprint">Imprint</a>
            

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/dev">Technical Resources</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans">Ground Truth Guidelines</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans/trPage">PAGE-XML format documentation</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/dev-best-practice">OCR-D development best practices</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec">Specifications</a>

          

          

          
          

            
            <a class="navbar-item" href="/core">OCR-D/core API Documentation</a>

          

          
        </div>
      </div>
      

      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/use">User Guides & Info</a>
        <div class="navbar-dropdown">
          

          
          
            
            
              
              <a class="navbar-item" href="/en/setup">Setup Guide</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/user_guide">User Guide</a>
            

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/workflows">Workflows</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/models">Models</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec/glossary">Glossary</a>

          

          
        </div>
      </div>
      

      
      
        <a class="navbar-item" href="/en/faq">FAQ</a>
      

      
	 <span class="navbar-item">
	 
            <a href="" title="View in German"></a>
				<div class="navbar-item has-dropdown is-hoverable" style="padding-right:10px">Search
				<div class="navbar-dropdown" style="font-size: 0.75em; padding:5px">For this feature, we implemented Google Programmable Search Engine. 
					If you use it, please note that cookies may be stored and Privacy Policy by Google LLC applies: 
					<a href="https://policies.google.com/privacy">https://policies.google.com/privacy</a> 
					<button onclick="ToggleSearchActive2()" id="button-header">Agree, show me Google Search!</button></div>
				</div>
				<div id="google-search-header" style="visibility: hidden">
					<div class="gcse-search"></div>
				</div>
			
	</span>
    </div>

    <div class="navbar-end">

      <span class="navbar-item"> 
            <a href="/de/spec/docker.html" title="View in German"></a>

			</span>


    </div> </div> </nav>
<div class="columns">
      
      <aside id="toc-sidebar-content" class="column is-one-third menu is-hidden-mobile">
        <ul class="menu-list column is-one-third">
  <li><a href="#dockerfile-provided-by-mp">Dockerfile provided by MP</a>
    <ul>
      <li><a href="#based-on-ocrdcore">Based on ocrd:core</a></li>
      <li><a href="#naming-images">Naming images</a></li>
      <li><a href="#labelling-images">Labelling images</a></li>
      <li><a href="#shell-entrypoint">Shell entrypoint</a></li>
      <li><a href="#data-as-volume"><code class="highlighter-rouge">/data</code> as volume</a></li>
      <li><a href="#example">Example</a>
        <ul>
          <li><a href="#dockerfile"><code class="highlighter-rouge">Dockerfile</code></a></li>
          <li><a href="#command-to-build-docker-image">Command to build docker image</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

      </aside>
      <div id="toc-sidebar-toggle">&lt;&gt;</div>
      

      <main class="container content column is-two-thirds" aria-label="Content">
        <h1 id="dockerfile-provided-by-mp">Dockerfile provided by MP</h1>

<p>MP should provide a
<a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a> that should
result in a container which bundles the <a href="cli">tools developed by the MP</a> along
with all requirements.</p>

<h2 id="based-on-ocrdcore">Based on ocrd:core</h2>

<p>Docker containers should be based on the <a href="https://hub.docker.com/r/ocrd/core/">ocrd base
image</a> which itself is based on Ubuntu
18.04. For one, this allows MP to use the <code class="highlighter-rouge">ocrd</code> tool to handle recurrent tasks
in a spec-conformant way. Besides, it locally installed and containerized
<a href="cli">CLI</a> interchangeable.</p>

<h2 id="naming-images">Naming images</h2>

<p>Image tags MUST be the same as the project name but with underscore (<code class="highlighter-rouge">_</code>)
replaced with forward slash (<code class="highlighter-rouge">/</code>).</p>

<p>Examples:</p>

<table>
  <thead>
    <tr>
      <th>project name</th>
      <th>docker tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://github.com/OCR-D/ocrd_tesserocr"><code class="highlighter-rouge">ocrd_tesserocr</code></a></td>
      <td><a href="https://hub.docker.com/r/ocrd/tesserocr"><code class="highlighter-rouge">ocrd/tesserocr</code></a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/OCR-D/ocrd_calamari"><code class="highlighter-rouge">ocrd_calamari</code></a></td>
      <td><a href="https://hub.docker.com/r/ocrd/calamari"><code class="highlighter-rouge">ocrd/calamari</code></a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/OCR-D/ocrd_olena"><code class="highlighter-rouge">ocrd_olena</code></a></td>
      <td><a href="https://hub.docker.com/r/ocrd/olena"><code class="highlighter-rouge">ocrd/olena</code></a></td>
    </tr>
  </tbody>
</table>

<h2 id="labelling-images">Labelling images</h2>

<p>The Dockerfile MUST accept build args <code class="highlighter-rouge">VCS_REF</code> and <code class="highlighter-rouge">BUILD_DATE</code>.</p>

<p><code class="highlighter-rouge">VCS_REF</code> contains the short id of the latest commit this image was built upon.</p>

<p><code class="highlighter-rouge">BUILD_DATE</code> contains an ISO-8601 date.</p>

<p>From these build args, the image shall be labelled with this command:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">LABEL</span><span class="s"> \</span>
    maintainer="https://github.com/YOUR/PROJECT/issues" \
    org.label-schema.vcs-ref=$VCS_REF \
    org.label-schema.vcs-url="https://github.com/YOUR/PROJECT" \
    org.label-schema.build-date=$BUILD_DATE
</code></pre></div></div>

<p><code class="highlighter-rouge">maintainer</code> and <code class="highlighter-rouge">org.label-schema.cvs-url</code> shall point to the issues and
landing page of the GitHub project resp.</p>

<h2 id="shell-entrypoint">Shell entrypoint</h2>

<p>No <code class="highlighter-rouge">CMD</code> should be provided.</p>

<p>No <code class="highlighter-rouge">ENTRYPOINT</code> should be provided.</p>

<p>If <code class="highlighter-rouge">CMD</code> or <code class="highlighter-rouge">ENTRYPOINT</code> are provided, they should be empty arrays.</p>

<h2 id="data-as-volume"><code class="highlighter-rouge">/data</code> as volume</h2>

<p>The directory <code class="highlighter-rouge">/data</code> in the the container should be marked as a volume to
allow processing host data in the container in a uniform way.</p>

<h2 id="example">Example</h2>

<h3 id="dockerfile"><code class="highlighter-rouge">Dockerfile</code></h3>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> ocrd:core</span>
<span class="k">VOLUME</span><span class="s"> ["/data"]</span>
<span class="k">ARG</span><span class="s"> VCS_REF</span>
<span class="k">ARG</span><span class="s"> BUILD_DATE</span>
<span class="k">LABEL</span><span class="s"> \</span>
    maintainer="https://github.com/bar/ocrd_foo/issues" \
    org.label-schema.vcs-ref=$VCS_REF \
    org.label-schema.vcs-url="https://github.com/bar/ocrd_foo" \
    org.label-schema.build-date=$BUILD_DATE

<span class="c"># RUN-commands to install requirements, build and install</span>
<span class="c"># e.g.</span>
<span class="c"># apt-get install -y curl</span>

<span class="k">ENTRYPOINT</span><span class="s"> []</span>
</code></pre></div></div>

<h3 id="command-to-build-docker-image">Command to build docker image</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build <span class="se">\</span>
  <span class="nt">-t</span> <span class="s1">'ocrd/foo'</span> <span class="se">\</span>
	<span class="nt">--build-arg</span> <span class="nv">VCS_REF</span><span class="o">=</span><span class="si">$(</span>git rev-parse <span class="nt">--short</span> HEAD<span class="si">)</span> <span class="se">\</span>
	<span class="nt">--build-arg</span> <span class="nv">BUILD_DATE</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> <span class="nt">-u</span> +<span class="s2">"%Y-%m-%dT%H:%M:%SZ"</span><span class="si">)</span>
</code></pre></div></div>

      </main>
    </div><footer class="footer" style="padding: 1rem">
    <div class="content has-text-centered">
      <img class="footer-logo" src="/assets/dfg_logo_eng.jpg" alt="DFG logo"/>
    </div>
    <!-- <div class="content has-text-centered"> -->
    <!--   <img class="footer-logo" src="/assets/logo-bbaw.png" alt="BBAW logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-hab.gif" alt="HAB logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-kit.png" alt="KIT logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-sbb.png" alt="SBB logo"/> -->
    <!-- </div> -->
    <div class="content has-text-centered">
		<a href="https://github.com/OCR-D">GitHub</a>
		|
		<a href="https://gitter.im/OCR-D/Lobby">Gitter</a>
		|
		<a href="https://github.com/OCR-D/ocrd-website/wiki">Wiki</a>
		|
		<a href="https://hub.docker.com/u/ocrd">Docker Hub</a>
		|
		<a href="https://www.zotero.org/groups/418719/ocr-d">Technology Watch</a>
		|
		<a href="/sitemap.xml">sitemap.xml</a>
		|
		
			<a href="/en/imprint">Imprint</a>
		
    </div>

<script src="/assets/script.js"></script>
</footer>
</body>

</html>
