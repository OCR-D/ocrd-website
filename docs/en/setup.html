<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/26362587?s=200&amp;v=4"></link>
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/bulma.css"></link>
  <link rel="stylesheet" href="/assets/syntax-highlight.css"></link>
  <link rel="stylesheet" href="/assets/ocrd.css"></link>
</head>
<body><nav class="navbar is-transparent is-fixed-top">

  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/assets/ocrd-logo-small.png" height="28"/>
    </a>
    <div class="navbar-burger burger" data-target="ocrd-navbar-menu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div id="ocrd-navbar-menu" class="navbar-menu">
    <div class="navbar-start">
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/">About</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/de/phase3">OCR-D Phase III</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/about">The OCR-D-project</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/contact">Get in touch!</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/blog">Blog</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/publications">Publications and Presentations</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/module-projects">Module Projects</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/data">Data</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/initial-tests">Initial tests</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/user_survey">User Survey</a>

          

          

          
          
            
            
              
              <a class="navbar-item" href="/en/imprint">Imprint</a>
            

          

          
        </div>
      </div>
      
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/dev">Developers</a>
        <div class="navbar-dropdown">
          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans">Ground Truth Guidelines</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/gt-guidelines/trans/trPage">PAGE-XML format documentation</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/dev-best-practice">OCR-D development best practices</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec">Specifications</a>

          

          

          
          

            
            <a class="navbar-item" href="/core">OCR-D/core API Documentation</a>

          

          
        </div>
      </div>
      
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/en/use">Users</a>
        <div class="navbar-dropdown">
          

          
          
            
            
              
              <a class="navbar-item" href="/en/setup">Setup Guide</a>
            

          

          

          
          

            
            <a class="navbar-item" href="/en/user_guide">User Guide</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/workflows">Workflows</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/models">Models</a>

          

          

          
          

            
            <a class="navbar-item" href="/en/spec/glossary">Glossary</a>

          

          
        </div>
      </div>
      
      
      
        <a class="navbar-item" href="/en/faq">FAQ</a>
      
      

    </div>

    <div class="navbar-end">

      <span class="navbar-item">
         
          
            <a href="https://translate.google.com/translate?hl=&sl=en&tl=de&u=https%3A%2F%2Focr-d.de%2Fen%2Fsetup" title="View in German">
              de
            </a>
           
      </span>

    </div> </div> </nav>
<div class="columns">
      
      <aside id="toc-sidebar-content" class="column is-one-third menu is-hidden-mobile">
        <ul class="menu-list column is-one-third">
  <li><a href="#ocr-d-setup-guide">OCR-D setup guide</a>
    <ul>
      <li><a href="#system-requirements">System requirements</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#ocrd_all">ocrd_all</a></li>
      <li><a href="#ocrd_all-via-docker">ocrd_all via Docker</a>
        <ul>
          <li><a href="#mini-medi-maxi">mini medi maxi</a></li>
          <li><a href="#fetch-docker-image">Fetch Docker image</a></li>
          <li><a href="#updating-docker-image">Updating Docker image</a></li>
        </ul>
      </li>
      <li><a href="#ocrd_all-natively">ocrd_all natively</a>
        <ul>
          <li><a href="#prerequisites">Prerequisites</a></li>
          <li><a href="#cloning-the-repository">Cloning the repository</a></li>
          <li><a href="#updating-the-repository">Updating the repository</a></li>
          <li><a href="#installing-with-ocrd_all">Installing with ocrd_all</a></li>
        </ul>
      </li>
      <li><a href="#individual-installation">Individual installation</a>
        <ul>
          <li><a href="#individual-docker-container">Individual Docker container</a></li>
          <li><a href="#native-installation">Native installation</a>
            <ul>
              <li><a href="#virtualenv">virtualenv</a></li>
              <li><a href="#from-pypi">From PyPI</a></li>
              <li><a href="#from-git">From git</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#testing-the-installation">Testing the installation</a>
        <ul>
          <li><a href="#test-native-installation">Test native installation</a></li>
          <li><a href="#test-docker-installation">Test Docker installation</a></li>
        </ul>
      </li>
      <li><a href="#installation-of-ocr-d-research-data-repository">Installation of OCR-D Research Data Repository</a>
        <ul>
          <li><a href="#testing-the-installation-1">Testing the installation</a></li>
        </ul>
      </li>
      <li><a href="#installation-of-taverna-workflow">Installation of Taverna Workflow</a>
        <ul>
          <li><a href="#why-using-taverna">Why using Taverna?</a></li>
          <li><a href="#native-installation-1">Native installation</a>
            <ul>
              <li><a href="#testing-the-installation-2">Testing the installation</a></li>
            </ul>
          </li>
          <li><a href="#docker-installation">Docker installation</a>
            <ul>
              <li><a href="#testing-the-installation-3">Testing the installation</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#running-a-small-workflow-without-taverna">Running a small workflow without Taverna</a>
        <ul>
          <li><a href="#with-pypi-and-workflow-engine-from-core">With PyPI and workflow engine from core</a></li>
        </ul>
      </li>
      <li><a href="#installation-of-ocrd_framework">Installation of ocrd_framework</a>
        <ul>
          <li><a href="#prepare-etchosts-for-accessing-files-in-repository-via-browser">Prepare ‘/etc/hosts’ for accessing files in repository via browser</a>
            <ul>
              <li><a href="#testing-the-installation-4">Testing the installation</a></li>
              <li><a href="#check-results-in-browser">Check results in browser</a></li>
              <li><a href="#configure-your-own-workflow">Configure your own workflow</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

      </aside>
      <div id="toc-sidebar-toggle">&lt;&gt;</div>
      

      <main class="container content column is-two-thirds" aria-label="Content">
        <h1 id="ocr-d-setup-guide">OCR-D setup guide</h1>

<p>OCR-D’s software is a modular collection of many projects (called <em>modules</em>)
with many tools per module (called <em>processors</em>) that you can combine freely
to achieve the workflow best suited for OCRing your content.</p>

<h2 id="system-requirements">System requirements</h2>

<p>Minimum system requirements</p>
<ul>
  <li>8 GB RAM (more recommended)
    <ul>
      <li>The more RAM is available, the more concurrent processes can be run</li>
      <li>Exceedingly large images (newspapers, folio-size books…) require a lot of RAM</li>
    </ul>
  </li>
  <li>min. 100 GB free disk space for local installation
    <ul>
      <li>~10 GB for <a href="https://github.com/OCR-D/ocrd_all"><code class="highlighter-rouge">ocrd_all</code></a>, including dependencies</li>
      <li>~10 GB for various <a href="https://ocr-d.de/en/models">pretrained models</a></li>
      <li>~10 GB for training and evaluation data for training, as well as trained (intermediate) models</li>
      <li>~20 GB for data to process</li>
      <li>double the space requirements to be able to <a href="https://github.com/OCR-D/ocrd_all/pull/118">isolate virtualenvs</a> and store backups of (intermediate) data</li>
    </ul>
  </li>
  <li>Operating system: Ubuntu 18.04
    <ul>
      <li>Ubuntu 18.04 is our target platform because it was the most up-to-date Ubuntu LTS release when we started developing and <a href="https://ubuntu.com/about/release-cycle">will be supported for the foreseeable future</a></li>
      <li>Other Linux distributions or Ubuntu versions can also be used, though some instructions have to be adapted (e.g. package management, locations of some files)</li>
      <li>With Windows Subsystem for Linux (WSL), a feature of Windows 10, it is <a href="https://github.com/OCR-D/ocrd-website/wiki/OCR-D-on-Windows">also possible to set up an Ubuntu 18.04 installation within Microsoft Windows</a></li>
      <li>OCR-D can be deployed on an <a href="https://github.com/OCR-D/ocrd-website/wiki/OCR-D-on-macOS">Apple MacOSX machine using Homebrew</a></li>
    </ul>
  </li>
  <li>Python 3.5, 3.6 or 3.7
    <ul>
      <li>OCR-D’s target Python version is currently Python 3.5 which we will continue to support until at least the end of 2020</li>
      <li>Python 3.6 and 3.7 are also tested and supported</li>
      <li>We currently <strong>cannot fully support Python 3.8</strong>, because there currently (July 2020) are no pre-built Python packages for Tensorflow and other GPU related software). We expect to unconditionally support Python 3.8 in Q4 2020 or Q1 2021 the latest.</li>
    </ul>
  </li>
</ul>

<p>For installation on Windows 10 (WSL) and macOS see the setup guides in the <a href="https://github.com/OCR-D/ocrd-website/wiki">OCR-D-Wiki</a></p>

<p>Alternatively, use <a href="https://hub.docker.com/u/ocrd">Docker</a></p>

<h2 id="installation">Installation</h2>

<p>All <a href="https://github.com/topics/ocr-d">OCR-D modules</a> follow the same
<a href="https://ocr-d.github.io/cli">interface</a> and common design patterns. So once
you understand how to install and use one project, you know how to install and
use all of them.</p>

<p>There are four ways to install OCR-D modules:</p>

<ol>
  <li><a href="#ocrd_all-via-docker">Using</a> the <a href="https://hub.docker.com/r/ocrd/all">ocrd_all prebuilt Docker images <code class="highlighter-rouge">ocrd/all</code></a> to install a module collection (<strong>recommended</strong>)</li>
  <li><a href="#ocrd_all-natively">Using</a> the <a href="https://github.com/OCR-D/ocrd_all">ocrd_all git repository</a> to install selected modules natively</li>
  <li><a href="#individual-installation">Installing</a> modules individually, either via Docker or natively (not recommended)</li>
  <li><a href="#installation-of-ocrd_framework">Using</a> the <a href="https://github.com/VolkerHartmann/ocrd_framework">ocrd_framework repository</a> to install all modules, Taverna workflow and research data repository as a local Docker image</li>
</ol>

<p>We recommend using the prebuilt Docker images since this does not require any changes to
the host system besides <a href="https://hub.docker.com/r/ocrd/all">installing Docker</a>.</p>

<p>We do not recommend installing modules individually, because it can be difficult to catch all dependencies, 
keep the software up-to-date and ensure that they are at usable and interoperable versions.</p>

<h2 id="ocrd_all">ocrd_all</h2>

<p>The <a href="https://github.com/OCR-D/ocrd_all"><code class="highlighter-rouge">ocrd_all</code></a> project is an effort by the
OCR-D community, now maintained by the OCR-D coordination team. It streamlines
the native installation of OCR-D modules with a versatile Makefile approach.
Besides allowing native installation of the full OCR-D stack (or any subset),
it is also the base for the <a href="https://hub.docker.com/r/ocrd/all"><code class="highlighter-rouge">ocrd/all</code></a>
Docker images available from DockerHub that contain the full stack (or certain subsets)
of OCR-D modules ready for deployment.</p>

<p>Technically, <code class="highlighter-rouge">ocrd_all</code> is a Git repository that keeps all the necessary software
as Git submodules at specific revisions. This way, the software tools are known
to be at a stable version and guaranteed to be interoperable with one another.</p>

<h2 id="ocrd_all-via-docker">ocrd_all via Docker</h2>

<h3 id="mini-medi-maxi">mini medi maxi</h3>

<p>There are three versions of the
<a href="https://hub.docker.com/r/ocrd/all"><code class="highlighter-rouge">ocrd/all</code></a> image:
<code class="highlighter-rouge">minimum</code>, <code class="highlighter-rouge">medium</code> and <code class="highlighter-rouge">maximum</code>. They differ in which modules are included
and hence the size of the image. Only use the <code class="highlighter-rouge">minimum</code> or <code class="highlighter-rouge">medium</code> images if
you are certain that you do not need the full OCR-D stack for your workflows, otherwise
we encourage you to use the large but complete <code class="highlighter-rouge">maximum</code> image.</p>

<p>Check this table to see which modules are included in which version:</p>

<table>
  <thead>
    <tr>
      <th>Module</th>
      <th><code class="highlighter-rouge">minimum</code></th>
      <th><code class="highlighter-rouge">medium</code></th>
      <th><code class="highlighter-rouge">maximum</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>core</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_cis</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_fileformat</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_im6convert</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_pagetopdf</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_repair_inconsistencies</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_tesserocr</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>tesserocr</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>workflow-configuration</td>
      <td>☑</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>cor-asv-ann</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>dinglehopper</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>format-converters</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_calamari</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_keraslm</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_olena</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_segment</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>tesseract</td>
      <td>-</td>
      <td>☑</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_anybaseocr</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_kraken</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_ocropy</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_pc_segmentation</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>ocrd_typegroups_classifier</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>sbb_textline_detector</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
    <tr>
      <td>cor-asv-fst</td>
      <td>-</td>
      <td>-</td>
      <td>☑</td>
    </tr>
  </tbody>
</table>

<h3 id="fetch-docker-image">Fetch Docker image</h3>

<p>To fetch the <code class="highlighter-rouge">maximum</code> version of the <code class="highlighter-rouge">ocrd/all</code> Docker image:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pull ocrd/all:maximum
</code></pre></div></div>

<p>Replace <code class="highlighter-rouge">maximum</code> accordingly if you want the <code class="highlighter-rouge">minimum</code> or <code class="highlighter-rouge">medium</code> variant.</p>

<p>(Also, if you want to keep the modules’ git repos inside the Docker images – so you can keep making fast updates, without waiting for a new pre-built image but also without building an image yourself –, then add the suffix <code class="highlighter-rouge">-git</code> to the variant, e.g. <code class="highlighter-rouge">maximum-git</code>. This will behave like the native installation, only inside the container. Yes, you can also <a href="https://rollout.io/blog/using-docker-commit-to-create-and-change-an-image/">commit changes</a> made in containers back to your local Docker image.)</p>

<h3 id="updating-docker-image">Updating Docker image</h3>

<p>To update the docker images to their latest version, just run the <code class="highlighter-rouge">docker pull</code> command again:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pull ocrd/all:&lt;version&gt;
</code></pre></div></div>

<p>This can even be set up as a cron-job to ensure the image is always up-to-date.</p>

<h2 id="ocrd_all-natively">ocrd_all natively</h2>

<p>The <code class="highlighter-rouge">ocrd_all</code> project contains a sophisticated Makefile to install or compile
prerequisites as necessary, set up a virtualenv, install the core software,
install OCR-D modules and more. Detailed documentation <a href="https://github.com/OCR-D/ocrd_all">can be found in its
README</a>.</p>

<h3 id="prerequisites">Prerequisites</h3>

<p>There are some <a href="https://github.com/OCR-D/ocrd_all#system-packages">system requirements</a> for ocrd_all.</p>

<p>You need to have <code class="highlighter-rouge">git</code> and <code class="highlighter-rouge">make</code> installed to make use of <code class="highlighter-rouge">ocrd_all</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>git make
</code></pre></div></div>

<p>It is easiest to install all the possible system requirements by calling <code class="highlighter-rouge">make deps-ubuntu</code> as root:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>make deps-ubuntu
</code></pre></div></div>

<h3 id="cloning-the-repository">Cloning the repository</h3>

<p>Clone the repository (still without submodules):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/OCR-D/ocrd_all
<span class="nb">cd </span>ocrd_all
</code></pre></div></div>

<h3 id="updating-the-repository">Updating the repository</h3>

<p>As <code class="highlighter-rouge">ocrd_all</code> is in <a href="https://github.com/OCR-D/ocrd_all/commits/master">active
development</a>, it is wise to
regularly update the repository and its submodules:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull
</code></pre></div></div>

<h3 id="installing-with-ocrd_all">Installing with ocrd_all</h3>

<p>You can either install</p>
<ol>
  <li>all the software at once with the <code class="highlighter-rouge">all</code> target (equivalent to the <a href="#mini-medi-maxi"><code class="highlighter-rouge">maximum</code> Docker version</a>),</li>
  <li>modules individually by using an executable from that module as the target, or</li>
  <li>a subset of modules by listing the project names in the <code class="highlighter-rouge">OCRD_MODULES</code> variable (equivalent to a custom selection of the <a href="#mini-medi-maxi"><code class="highlighter-rouge">medium</code> Docker version</a>):</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make all                       <span class="c"># Installs all the software (recommended)</span>

make ocrd-tesserocr-binarize   <span class="c"># Install ocrd_tesserocr which contains ocrd-tesserocr-binarize</span>
make ocrd-cis-ocropy-binarize  <span class="c"># Install ocrd_cis  which contains ocrd-cis-ocropy-binarize</span>

make all <span class="nv">OCRD_MODULES</span><span class="o">=</span><span class="s2">"core ocrd_tesserocr ocrd_cis"</span> <span class="c"># Will install only ocrd_tesserocr and ocrd_cis</span>
</code></pre></div></div>

<p>(Custom choices for <code class="highlighter-rouge">OCRD_MODULES</code> and other control variables (cf. <code class="highlighter-rouge">make help</code>) can also be made permanent by writing them into <code class="highlighter-rouge">Makefile.local</code>.)</p>

<p><em>*Note: Never run <code class="highlighter-rouge">make all</code> as root unless you know *exactly</em> what you are doing!</p>

<p>Installation is incremental, i.e. failed/interrupted attempts can be continued, and modules can be installed one at a time as needed.</p>

<p>Running <code class="highlighter-rouge">make</code> will also take care of cloning and updating all required submodules.</p>

<h2 id="individual-installation">Individual installation</h2>

<p>With all variants of individual module installation, it will be up to you to
keep the repositories up-to-date and installed. We therefore discourage
individual installation of modules and recommend using ocrd_all as outlined above..</p>

<h3 id="individual-docker-container">Individual Docker container</h3>

<p>This is the best option if you want full control over which modules you
actually intend to use while still profiting from the simple installation of
Docker containers.</p>

<p>You need to have <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">Docker</a></p>

<p>Many OCR-D modules are also <a href="https://hub.docker.com/u/ocrd">published as Docker containers to DockerHub</a>. To find the Docker
image for a module, replace the <code class="highlighter-rouge">ocrd_</code> prefix with <code class="highlighter-rouge">ocrd/</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pull ocrd/tesserocr  <span class="c"># Installs ocrd_tesserocr</span>
docker pull ocrd/olena  <span class="c"># Installs ocrd_olena</span>
</code></pre></div></div>

<p>To run the containers after successful installation, please see <a href="/en/user_guide.md#translating-native-commands-to-docker-calls">the notes on translating native command line
calls to docker calls above</a>. Make sure the image
name matches the executable. For example to run the same example in the dedicated <code class="highlighter-rouge">ocrd_tesserocr</code> container:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-u</span> <span class="si">$(</span><span class="nb">id</span> <span class="nt">-u</span><span class="si">)</span> <span class="nt">-w</span> /data <span class="nt">-v</span> <span class="nv">$PWD</span>:/data <span class="nt">--</span> ocrd/tesserocr ocrd-tesserocr-segment-region <span class="nt">-I</span> OCR-D-IMG <span class="nt">-O</span> OCR-D-SEG-BLOCK-DOCKER
</code></pre></div></div>

<h3 id="native-installation">Native installation</h3>

<p>Installing each module into your system natively requires you to know and install all its <em>dependencies</em> first.
That can be <em>system packages</em> (or even system package repositories) or <em>Python packages</em>.</p>

<p>To learn about system dependencies, consult the module’s README files. In contrast, Python dependencies should
be resolved automatically by using the Python package manager <code class="highlighter-rouge">pip</code>.</p>

<blockquote>
  <p><strong>NOTE</strong></p>

  <p>ocrd_tesserocr requires <strong>tesseract-ocr &gt;= 4.1.0</strong>. But the Tesseract packages
bundled with <strong>Ubuntu &lt; 19.10</strong> are too old. If you are on Ubuntu 18.04 LTS,
please enable <a href="https://launchpad.net/~alex-p/+archive/ubuntu/tesseract-ocr">Alexander Pozdnyakov PPA</a>,
which has up-to-date builds of tesseract and its dependencies:</p>

  <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>add-apt-repository ppa:alex-p/tesseract-ocr
<span class="nb">sudo </span>apt-get update
</code></pre></div>  </div>
</blockquote>

<p>Next subsections:</p>
<ul>
  <li>For Python you also first need <a href="#virtualenv">virtualenv</a>. Then you have two options:</li>
  <li>installing <a href="#from-pypi">via PyPI</a> or</li>
  <li>installing <a href="#from-git">via local git clone</a>.</li>
</ul>

<h4 id="virtualenv">virtualenv</h4>

<ul>
  <li><strong>Always install python modules into a virtualenv</strong></li>
  <li><strong>Never run <code class="highlighter-rouge">pip</code>/<code class="highlighter-rouge">pip3</code> as root</strong></li>
</ul>

<p>First install Python 3 and <code class="highlighter-rouge">venv</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>python3 python3-venv
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># If you haven't created the venv yet:</span>
python3 <span class="nt">-m</span> venv ~/venv
<span class="c"># Activate the venv</span>
<span class="nb">source</span> ~/venv/bin/activate
</code></pre></div></div>

<p>Once you have activated the virtualenv, you should see <code class="highlighter-rouge">(venv)</code> prepended to
your shell prompt.</p>

<h4 id="from-pypi">From PyPI</h4>

<p>This is the best option if you want to use the stable, released version of individual modules.</p>

<p>However, many modules require a number of non-Python (system) packages. For the
exact list of packages you need to look at the README of the module in
question. (If you are not on Ubuntu &gt;= 18.04, then your requirements may
deviate from that.)</p>

<p>For example to install <code class="highlighter-rouge">ocrd_tesserocr</code> from PyPI:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>git python3 python3-pip python3-venv libtesseract-dev libleptonica-dev tesseract-ocr-eng tesseract-ocr wget
pip3 <span class="nb">install </span>ocrd_tesserocr
</code></pre></div></div>

<p>Many ocrd modules conventionally contain a Makefile with a <code class="highlighter-rouge">deps-ubuntu</code> target that can handle calls to <code class="highlighter-rouge">apt-get</code> for you:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>make deps-ubuntu
</code></pre></div></div>

<h4 id="from-git">From git</h4>

<p>This is the best option if you want to change the source code or install the latest, unpublished changes.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/OCR-D/ocrd_tesserocr
<span class="nb">cd </span>ocrd_tesserocr
<span class="nb">sudo </span>make deps-ubuntu <span class="c"># or manually with apt-get</span>
make deps             <span class="c"># or pip3 install -r requirements</span>
make <span class="nb">install</span>          <span class="c"># or pip3 install .</span>
</code></pre></div></div>

<p>If you intend to develop a module, it is best to install the module editable:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install</span> <span class="nt">-e</span> <span class="nb">.</span>
</code></pre></div></div>

<p>This way, you won’t have to reinstall after making changes.</p>

<h2 id="testing-the-installation">Testing the installation</h2>

<p>For example, let’s fetch a document from the <a href="https://ocr-d-repo.scc.kit.edu/api/v1/metastore/bagit/">OCR-D GT Repo</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="s1">'https://ocr-d-repo.scc.kit.edu/api/v1/dataresources/736a2f9a-92c6-4fe3-a457-edfa3eab1fe3/data/wundt_grundriss_1896.ocrd.zip'</span>
unzip wundt_grundriss_1896.ocrd.zip
<span class="nb">cd </span>data
</code></pre></div></div>

<h3 id="test-native-installation">Test native installation</h3>

<p>This section applies if you installed the software natively, either <a href="#ocrd_all-natively">via
<code class="highlighter-rouge">ocrd_all</code></a> or <a href="#native-installation">on a per-module basis</a>.</p>

<p>First, activate your venv:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Activate the venv</span>
<span class="nb">source</span> ~/venv/bin/activate
</code></pre></div></div>

<p>Let’s segment the images in file group <code class="highlighter-rouge">OCR-D-IMG</code> into regions (creating a
first <a href="https://github.com/PRImA-Research-Lab/PAGE-XML">PAGE-XML</a> file group
<code class="highlighter-rouge">OCR-D-SEG-BLOCK</code>):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ocrd-tesserocr-segment-region <span class="nt">-I</span> OCR-D-IMG <span class="nt">-O</span> OCR-D-SEG-BLOCK
</code></pre></div></div>

<h3 id="test-docker-installation">Test Docker installation</h3>

<p>This section applies if you installed the software as docker container(s), either <a href="#ocrd_all-via-docker">via
<code class="highlighter-rouge">ocrd_all</code></a> or <a href="#individual-docker-container">on a per-module basis</a>.</p>

<p>You can spin up a docker container, mounting the current working directory like this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-u</span> <span class="si">$(</span><span class="nb">id</span> <span class="nt">-u</span><span class="si">)</span> <span class="nt">-w</span> /data <span class="nt">-v</span> <span class="nv">$PWD</span>:/data <span class="nt">--</span> ocrd/all:maximum ocrd-tesserocr-segment-region <span class="nt">-I</span> OCR-D-IMG <span class="nt">-O</span> OCR-D-SEG-BLOCK-DOCKER
</code></pre></div></div>

<p>Note that the CLI is exactly the same, the only difference is the prefix to instruct Docker, as <a href="#mini-medi-maxi">explained above</a></p>

<h2 id="installation-of-ocr-d-research-data-repository">Installation of OCR-D Research Data Repository</h2>

<p>It’s highly recommended to install the research data repository via Docker. <a href="https://github.com/OCR-D/repository_metastore/blob/master/installDocker/installation.md">See link for further information</a></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/OCR-D/repository_metastore
<span class="nb">cd </span>repository_metastore/installDocker
bash installRepo.sh ~/ocrd/repository
<span class="nb">cd</span> ~/ocrd/repository/docker
docker-compose up &amp;
<span class="c"># To stop research data repository</span>
docker-compose stop
</code></pre></div></div>

<h3 id="testing-the-installation-1">Testing the installation</h3>

<p>The write access to the service is secured with a password, which is preset
when you use the docker installation. There is an ‘ingest’ user for ingesting
files. (Password: <code class="highlighter-rouge">ingest</code>)</p>

<ol>
  <li>Upload zipped BagIt container to metastore.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-u</span> ingest:ingest <span class="nt">-v</span> <span class="nt">-F</span> <span class="s2">"file=@zippedBagItContainer"</span> http://localhost:8080/api/v1/metastore/bagit 
</code></pre></div>    </div>
  </li>
  <li>List all BagIt containers.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-XGET</span> <span class="nt">-H</span> <span class="s2">"Accept:application/json"</span>  http://localhost:8080/api/v1/metastore/bagit 
</code></pre></div>    </div>
  </li>
  <li>List all METS files.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-XGET</span> http://localhost:8080/api/v1/metastore/mets
</code></pre></div>    </div>
  </li>
  <li>List all METS files with title ‘Der Herold’.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-XGET</span> <span class="nt">-H</span> <span class="s2">"Accept:application/json"</span> <span class="s2">"http://localhost:8080/api/v1/metastore/mets/title?title=Der%20Herold"</span>
</code></pre></div>    </div>
  </li>
  <li>Download zipped BagIt container from metastore. (use one URL of the list printed above)
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-XGET</span> http://localhost:8090/api/v1/dataresources/123..../data/zippedBagItContainer <span class="o">&gt;</span> bagDownload.zip
</code></pre></div>    </div>
    <p>You may also try this URL in a browser. (http://localhost:8080/api/v1/metastore/bagit)</p>
  </li>
</ol>

<h2 id="installation-of-taverna-workflow">Installation of Taverna Workflow</h2>

<h3 id="why-using-taverna">Why using Taverna?</h3>

<p>Taverna creates a <code class="highlighter-rouge">metadata</code> subdirectory containing collected output of all
processors: all intermediate METS files and a provenance file containing all
provenance of the workflow including start/end time of processor/workflow, used
input group(s), used parameters and created output group(s).</p>

<p>There are two ways to install <code class="highlighter-rouge">taverna_workflow</code>:</p>
<ol>
  <li>native installation</li>
  <li>Docker installation</li>
</ol>

<h3 id="native-installation-1">Native installation</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/OCR-D/taverna_workflow.git
<span class="nb">cd </span>taverna_workflow/
bash installTaverna.sh ~/ocrd/taverna
</code></pre></div></div>

<h4 id="testing-the-installation-2">Testing the installation</h4>

<p>To check if the installation works fine you can start a first test.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/ocrd/taverna
bash startWorkflow.sh parameters_all.txt
<span class="o">[</span>...]
Outputs will be saved to the directory: /.../Execute_OCR_D_workfl_output
<span class="c"># The processed workspace should look like this:</span>
<span class="nb">ls</span> <span class="nt">-1</span> workspace/example/data/
metadata
mets.xml
OCR-D-GT-SEG-BLOCK
OCR-D-GT-SEG-PAGE
OCR-D-IMG
OCR-D-IMG-BIN
OCR-D-IMG-BIN-OCROPY
OCR-D-OCR-CALAMARI_GT4HIST
OCR-D-OCR-TESSEROCR-BOTH
OCR-D-OCR-TESSEROCR-FRAKTUR
OCR-D-OCR-TESSEROCR-GT4HISTOCR
OCR-D-SEG-LINE
OCR-D-SEG-REGION
</code></pre></div></div>

<p>Each sub folder starting with ‘OCR-D-OCR’ should now contain 4 files with the
detected full text.</p>

<h3 id="docker-installation">Docker installation</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://raw.githubusercontent.com/OCR-D/taverna_workflow/master/Dockerfile
docker build <span class="nt">-t</span> ocrd/taverna <span class="nb">.</span>
<span class="nb">mkdir</span> ~/docker/ocrd/taverna
<span class="nb">cd</span> ~/docker/ocrd/taverna
docker run <span class="nt">-v</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/data ocrd/taverna init
</code></pre></div></div>

<h4 id="testing-the-installation-3">Testing the installation</h4>

<p>To check if the installation works fine you can start a first test.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/docker/ocrd/taverna
docker run <span class="nt">--network</span><span class="o">=</span><span class="s2">"host"</span> <span class="nt">-v</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/data ocrd/taverna testWorkflow
<span class="o">[</span>...]
Outputs will be saved to the directory: /.../Execute_OCR_D_workfl_output
<span class="c"># The processed workspace should look like this:</span>
<span class="nb">ls</span> <span class="nt">-1</span> workspace/example/data/
metadata
mets.xml
OCR-D-GT-SEG-BLOCK
OCR-D-GT-SEG-PAGE
OCR-D-IMG
OCR-D-IMG-BIN
OCR-D-IMG-BIN-OCROPY
OCR-D-OCR-CALAMARI_GT4HIST
OCR-D-OCR-TESSEROCR-BOTH
OCR-D-OCR-TESSEROCR-FRAKTUR
OCR-D-OCR-TESSEROCR-GT4HISTOCR
OCR-D-SEG-LINE
OCR-D-SEG-REGION
</code></pre></div></div>

<p>Each sub folder starting with ‘OCR-D-OCR’ should now contain 4 files with the detected full text.</p>

<h2 id="running-a-small-workflow-without-taverna">Running a small workflow without Taverna</h2>

<h3 id="with-pypi-and-workflow-engine-from-core">With PyPI and workflow engine from core</h3>

<p>The <a href="https://github.com/OCR-D/core">core package</a> will be installed with every
OCR-D module package, but you can also install it manually:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>ocrd
</code></pre></div></div>

<p>Its CLI <code class="highlighter-rouge">ocrd</code> contains a simple workflow engine, available with the <code class="highlighter-rouge">ocrd process</code> command, which allows you to chain multiple OCR-D processor calls into simple sequential workflows.</p>

<p>For example, let’s combine the ocropy-based binarization of the
<a href="https://github.com/cisocrgroup/ocrd_cis">ocrd_cis</a> module project with the segmentation and recognition
in <a href="https://github.com/OCR-D/ocrd_tesserocr">ocrd_tesserocr</a>.</p>

<p>First, install ocrd_cis, too:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install ocrd_cis</span>
pip3 <span class="nb">install </span>ocrd_cis <span class="c"># with pip</span>
</code></pre></div></div>

<p>Next, install a suitable OCR model for Tesseract:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install OCR model into Tesseract datapath</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>tesseract-ocr-script-frak
</code></pre></div></div>

<p>Now we can define the workflow (as a list of processor calls in abbreviated
form, and a number of parameter files where defaults are insufficient):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create parameter files</span>
<span class="nb">echo</span> <span class="s1">'{ "model": "Fraktur" }'</span> <span class="o">&gt;</span> param-tess-fraktur.json

<span class="c"># Run workflow</span>
ocrd process <span class="se">\</span>
  <span class="s1">'cis-ocropy-binarize -I OCR-D-IMG -O OCR-D-SEG-PAGE'</span> <span class="se">\</span>
  <span class="s1">'tesserocr-segment-region -I OCR-D-SEG-PAGE -O OCR-D-SEG-BLOCK'</span> <span class="se">\</span>
  <span class="s1">'tesserocr-segment-line -I OCR-D-SEG-BLOCK -O OCR-D-SEG-LINE'</span> <span class="se">\</span>
  <span class="s1">'tesserocr-recognize -I OCR-D-SEG-LINE -O OCR-D-OCR-TESSEROCR -p param-tess-fraktur.json'</span> 
</code></pre></div></div>

<h2 id="installation-of-ocrd_framework">Installation of ocrd_framework</h2>

<p>To install the complete OCR-D framework Docker is highly recommended.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/VolkerHartmann/ocrd_framework/blob/master/install_OCR-D_framework.sh
bash install_OCR-D_framework.sh ~/ocrd_framework
</code></pre></div></div>

<p>Now there exist several folders:</p>

<ul>
  <li><code class="highlighter-rouge">repository</code> - Contains all files of repository and the databases</li>
  <li><code class="highlighter-rouge">taverna</code> - Contains all files workspaces and configuration of workflows</li>
</ul>

<h3 id="prepare-etchosts-for-accessing-files-in-repository-via-browser">Prepare ‘/etc/hosts’ for accessing files in repository via browser</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'127.0.0.1   kitdm20'</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts 
</code></pre></div></div>

<h4 id="testing-the-installation-4">Testing the installation</h4>

<p>To check if the installation works fine you can start a first test.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start repo in a shell</span>
<span class="nb">cd</span> ~/ocrd_framework/repository
docker-compose up 
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/ocrd_framework/taverna
docker run <span class="nt">--network</span><span class="o">=</span><span class="s2">"host"</span> <span class="nt">-v</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/data ocrd/taverna testWorkflow
<span class="o">[</span>...]
Outputs will be saved to the directory: /.../Execute_OCR_D_workfl_output
<span class="c"># The processed workspace should look like this:</span>
<span class="nb">ls</span> <span class="nt">-1</span> workspace/example/data/
metadata
mets.xml
OCR-D-GT-SEG-BLOCK
OCR-D-GT-SEG-PAGE
OCR-D-IMG
OCR-D-IMG-BIN
OCR-D-IMG-BIN-OCROPY
OCR-D-OCR-CALAMARI_GT4HIST
OCR-D-OCR-TESSEROCR-BOTH
OCR-D-OCR-TESSEROCR-FRAKTUR
OCR-D-OCR-TESSEROCR-GT4HISTOCR
OCR-D-SEG-LINE
OCR-D-SEG-REGION
</code></pre></div></div>

<p>Each sub folder starting with ‘OCR-D-OCR’ should now contain 4 files with the detected full text.</p>

<h4 id="check-results-in-browser">Check results in browser</h4>

<p>After the workflow all results are ingested to the research data repository.
The repository is available at http://localhost:8080/api/v1/metastore/bagit</p>

<h4 id="configure-your-own-workflow">Configure your own workflow</h4>

<p>For defining your own workflow with taverna please refer to the
<a href="https://github.com/OCR-D/taverna_workflow/blob/master/README.MD#configure-your-own-workflow">README</a></p>

      </main>
    </div><footer class="footer" style="padding: 1rem">
    <div class="content has-text-centered">
      <img class="footer-logo" src="/assets/dfg_logo_eng.jpg" alt="DFG logo"/>
    </div>
    <!-- <div class="content has-text-centered"> -->
    <!--   <img class="footer-logo" src="/assets/logo-bbaw.png" alt="BBAW logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-hab.gif" alt="HAB logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-kit.png" alt="KIT logo"/> -->
    <!--   <img class="footer-logo" src="/assets/logo-sbb.png" alt="SBB logo"/> -->
    <!-- </div> -->
    <div class="content has-text-centered">
      <a href="https://github.com/OCR-D">GitHub</a>
      |
      <a href="https://gitter.im/OCR-D/Lobby">gitter</a>
      |
      <a href="https://hub.docker.com/u/ocrd">Docker Hub</a>
      |
      <a href="https://www.zotero.org/groups/418719/ocr-d">Technology Watch</a>
      |
      <a href="/sitemap.xml">sitemap.xml</a>
    </div>

<script src="/assets/script.js"></script>
</footer>
</body>

</html>
